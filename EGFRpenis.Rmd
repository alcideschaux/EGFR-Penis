# EGFR Expression in Penile Cancer
Last update: ```r {date()}```

```{r global_options}
library(knitr)
opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, cache = FALSE, fig.width = 9)
```

```{r DataSet}
# Loading the libraries and functions that will be used
source("StandardAnalysis3.R")
source("SurvivalPlot.R")
library(foreign) # For reading STATA data
library(survival)
library(plyr) # for revalue and rename
library(gmodels) # for CrossTable
# Loading the STATA dataset
penis.full <- read.dta("../penile tma 6-11-14 stata 12.dta", convert.underscore = TRUE)
# Selecting clinicopathologic variables from the full dataset
clinicopath <- c("age", "race", "invasive", "subtype", "site", "grade", "thick", "lvi", "pni", "level", "urethra", "hpv.pos", "nodes", "date.lymph.mo", "dissection.type", "tnm.tumor", "tnm.nodes", "stage", "treatment", "chemo", "radio", "recurrence", "progression", "mets", "dead", "died.disease", "outcome", "date.recurrence.mo", "date.progression.mo", "date.met.mo", "date.death.mo", "fu.last.mo")
# Selecting markers from the full dataset
markers <- c("egfr.median.score", "egfr.max.score")
# Creating the dataset using the selected clinicopathologic variables and markers
penis.all <- penis.full[c(clinicopath, markers)]
# Recoding levels
penis.all$grade <- revalue(as.factor(penis.all$grade), c(
        "1" = "Grade 1",
        "2" = "Grade 2",
        "3" = "Grade 3"
        ))
penis.all$subtype <- gsub(pattern = " SCC", replacement = "", x = penis.all$subtype)
penis.all$subtype <- revalue(penis.all$subtype, c(
        "Other Subtype" = "Others",
        "Warty-Basaloid" = "WB"
        ))
penis.all$subtype <- as.factor(penis.all$subtype)
penis.all$level <- revalue(penis.all$level, c(
        "Corpus Spongiosum/Dartos" = "CS/Dartos",
        "Corpus Cavernosum/Preputial Skin" = "CC/Skin",
        "Adjacent Structures" = "Other"
        ))
penis.all$thick <- revalue(penis.all$thick, c(
        "< 5mm" = "Less than 5 mm",
        ">10 mm" = "More than 10 mm"
        ))
# Selecting only invasive cases and dropping unused levels
penis.data <- subset(penis.all, invasive == "Yes", select = -invasive)
penis.data <- droplevels(penis.data)
# Saving the dataset that is used for analysis
write.csv(penis.data, "PenisDataset.csv")
# Defining colors for plots
nice.colors <- c("turquoise", "coral", "cornflowerblue")
# Attaching the dataset
attach(penis.data)
```

```{r Plots}
# Defining a function to describe categorical variables using a vertical barplot
descriptive.plot <- function(x, ...){
        x.table <- table(x)
        Plot <- barplot(x.table, ylab = "No. Patients", cex.lab = 1.25, ...)
        text(Plot, paste("N =", x.table), y = x.table, pos = 3)
}
# Defining a function to describe categorical variables using a horizontal barplot
descriptive.plot.h <- function(x, left = 4, ...){
        x.table <- table(x)
        par(mar = c(5, left, 4, 2) + 0.1, las = 1)
        Plot <- barplot(x.table, xlab = "No. Patients", cex.lab = 1.25, horiz = TRUE, ...)
        text(Plot, paste("N =", x.table), x = x.table, pos = 4)
}
# Defining a function to describe categorical variables using juxtaposed vertical bars
descriptive.plot.beside <- function(x, y, ...){
        table.beside <- table(x, y)
        compare.fisher <- fisher.test(x, y)
        P <- format(compare.fisher$p.value, digits = 2, width = 6)
        plot.beside <- barplot(table.beside, beside = TRUE, col = nice.colors,
                               ylab = "No. Patients", cex.lab = 1.25,
                               legend.text = TRUE,
                               args.legend = list(x = "topright", bty = "n"),
                               ...)
        text(plot.beside, paste(table.beside), y = table.beside, pos = 3)
        legend("topleft", bty = "n", paste("Fisher's exact test P value =", P))
}
# Defining a function to describe categorical variables using juxtaposed horizontal bars
descriptive.plot.beside.h <- function(x, y, ...){
        table.beside <- table(x, y)
        compare.fisher <- fisher.test(x, y)
        P <- format(compare.fisher$p.value, digits = 2, width = 6)
        plot.beside <- barplot(table.beside, beside = TRUE, col = nice.colors,
                               xlab = "No. Patients", cex.lab = 1.25,
                               horiz = TRUE,
                               legend.text = TRUE,
                               args.legend = list(x = "topright", bty = "n"),
                               ...)
        text(plot.beside, paste(table.beside), x = table.beside, pos = 4)
        legend("right", bty = "n", paste("Fisher's exact test P value =", P))
}
# Defining a function to describe numerical variables using a histogram + boxplot
descriptive.numeric <- function(x, col1 = "coral", col2 = "turquoise", label, ...){
        par(mfrow = c(1, 2), cex.lab = 1.25)
        hist(x, freq = FALSE, main = "", ylab = "Probability Density", xlab = label,
             col = col1, ...)
        lines(density(x, na.rm = TRUE), lwd = 1.5, ...)
        boxplot(x, col = col2, ylab = label, ...)
}
# Defining a function for boxplots and Kruskal-Wallis test
boxplot.kruskal <- function(x, ...){
        par(mar = c(5, 4, 1, 2))
        KW <- kruskal.test(x)
        KW.plot <- boxplot(x, cex.lab = 1.25, ...)
        legend("topleft", bty = "n",
               paste("Kruskal-Wallis test P value =", format(KW$p.value, digits = 2, width = 6)))
}
# Defining a function for mosaic plots with row proportions
mosaic.plot <- function(x, y, ...){
        xy <- table(x, y)
        xy.row <- 100*prop.table(xy, 1)
        xy.round <- round(xy.row, 1)
        mosaic(xy, shade = TRUE, pop = FALSE, ...)
        labeling_cells(text = xy.round, margin = 0)(xy)
}
# Defining a function for mosaic plots
compare.mosaic <- function(x, y, ...){
        par(mar = c(1, 1, 2, 1) + 0.1)
        mosaicplot(table(x, y), color = nice.colors,
                   xlab = "", ylab = "", cex.axis = 1, ...)
        par(mar = c(5, 4, 4, 2) + 0.1)
}
```

***

## Descriptive Analysis

### Clinical Features

#### Patient's age
`r var <- age; t <- "Patient's Age, years"`

Statistics | Value
--- | :---:
Mean | `r round(mean(var, na.rm = TRUE), digits = 1)`
Standard Deviation | `r round(sd(var, na.rm = TRUE), digits = 1)`
Median | `r round(median(var, na.rm = TRUE), digits = 1)`
Interquartile Range | `r round(IQR(age, na.rm = TRUE), digits = 1)`
Minimum | `r min(var, na.rm = TRUE)`
Maximum | `r max(var, na.rm = TRUE)`

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptiveAge}
descriptive.numeric(var, label = t)
```

***

#### Patient's race
`r var <- race; var.t <- table(var); t <- "Patient's Race"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)
`r levels(var)[3]` | `r var.t[3]` (`r round(var.t[3]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptiveRace.plots}
descriptive.plot(var, col = nice.colors, ylim = c(0, 40), xlab = t)
```

***

### Pathologic Features

#### Histologic subtype
`r var <- subtype; var.t <- table(var)`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)
`r levels(var)[3]` | `r var.t[3]` (`r round(var.t[3]/sum(var.t)*100, digits = 1)`)
`r levels(var)[4]` | `r var.t[4]` (`r round(var.t[4]/sum(var.t)*100, digits = 1)`)
`r levels(var)[5]` | `r var.t[5]` (`r round(var.t[5]/sum(var.t)*100, digits = 1)`)
`r levels(var)[6]` | `r var.t[6]` (`r round(var.t[6]/sum(var.t)*100, digits = 1)`)
`r levels(var)[7]` | `r var.t[7]` (`r round(var.t[7]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptiveSubtype}
descriptive.plot.h(var, left = 10, col = rainbow(7), xlim = c(0, 40))
```

***

#### Anatomical site
`r var <- site; var.t <- table(var); t <- "Anatomical Site"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)
`r levels(var)[3]` | `r var.t[3]` (`r round(var.t[3]/sum(var.t)*100, digits = 1)`)
`r levels(var)[4]` | `r var.t[4]` (`r round(var.t[4]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptiveSite}
descriptive.plot(var, col = rainbow(4), ylim = c(0, 35), xlab = t)
```

***

#### Anatomical level
`r var <- level; var.t <- table(var)`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)
`r levels(var)[3]` | `r var.t[3]` (`r round(var.t[3]/sum(var.t)*100, digits = 1)`)
`r levels(var)[4]` | `r var.t[4]` (`r round(var.t[4]/sum(var.t)*100, digits = 1)`)
`r levels(var)[5]` | `r var.t[5]` (`r round(var.t[5]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptiveLevel}
descriptive.plot.h(var, left = 14, col = rainbow(5), xlim = c(0, 25))
```

***

#### Histologic grade
`r var <- grade; var.t <- table(var); t <- "Histologic Grade"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)
`r levels(var)[3]` | `r var.t[3]` (`r round(var.t[3]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptiveGrade}
descriptive.plot(var, col = nice.colors, ylim = c(0, 26), xlab = t)
```

***

#### Tumor thickness
`r var <- thick; var.t <- table(var); t <- "Tumor Thickness"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)
`r levels(var)[3]` | `r var.t[3]` (`r round(var.t[3]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptiveThickness}
descriptive.plot(var, col = nice.colors, ylim = c(0, 25), xlab = t)
```

***

#### Tumor invasion of penile urethra
`r var <- urethra; var.t <- table(var); t <- "Invasion of Penile Urethra"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptiveUrethra}
descriptive.plot(var, col = nice.colors, ylim = c(0, 50), xlab = t)
```

***

#### Lymphovascular invasion
`r var <- lvi; var.t <- table(var); t <- "Lymphovascular Invasion"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptiveLVI}
descriptive.plot(var, col = nice.colors, ylim = c(0, 40), xlab = t)
```

***

#### Perineural invasion
`r var <- pni; var.t <- table(var); t <- "Perineural Invasion"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptivePNI}
descriptive.plot(var, col = nice.colors, ylim = c(0, 40), xlab = t)
```

***

#### HPV infection
`r var <- hpv.pos; var.t <- table(var); t <- "HPV Infection"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptiveHPV}
descriptive.plot(var, col = nice.colors, xlab = t, ylim = c(0, 50))
```

***

#### Pathologic pT stage
`r var <- tnm.tumor; var.t <- table(var); t <- "pT Stage"`

Categorical Level | No. Cases (%)
--- | :---:
Stage `r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
Stage `r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)
Stage `r levels(var)[3]` | `r var.t[3]` (`r round(var.t[3]/sum(var.t)*100, digits = 1)`)
Stage `r levels(var)[4]` | `r var.t[4]` (`r round(var.t[4]/sum(var.t)*100, digits = 1)`)
Stage `r levels(var)[5]` | `r var.t[5]` (`r round(var.t[5]/sum(var.t)*100, digits = 1)`)
Stage `r levels(var)[6]` | `r var.t[6]` (`r round(var.t[6]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptivePT}
descriptive.plot(var, col = rainbow(6), ylim = c(0, 25), xlab = t)
```

***

#### Pathologic pN stage
`r var <- tnm.nodes; var.t <- table(var); t <- "pN Stage"`

Categorical Level | No. Cases (%)
--- | :---:
Stage `r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
Stage `r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)
Stage `r levels(var)[3]` | `r var.t[3]` (`r round(var.t[3]/sum(var.t)*100, digits = 1)`)
Stage `r levels(var)[4]` | `r var.t[4]` (`r round(var.t[4]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptivePN}
descriptive.plot(var, col = rainbow(4), ylim = c(0, 15), xlab = t)
```

***

#### Clinical stage
`r var <- stage; var.t <- table(var); t <- "Clinical Stage"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)
`r levels(var)[3]` | `r var.t[3]` (`r round(var.t[3]/sum(var.t)*100, digits = 1)`)
`r levels(var)[4]` | `r var.t[4]` (`r round(var.t[4]/sum(var.t)*100, digits = 1)`)
`r levels(var)[5]` | `r var.t[5]` (`r round(var.t[5]/sum(var.t)*100, digits = 1)`)
`r levels(var)[6]` | `r var.t[6]` (`r round(var.t[6]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptiveStage}
descriptive.plot(var, col = rainbow(6), ylim = c(0, 20), xlab = t)
```

***

#### Inguinal lymph node dissection
`r var <- dissection.type; var.t <- table(var); t <- "Inguinal Lymphadenectomy, Timing"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptiveDissection}
descriptive.plot(var, col = nice.colors, ylim = c(0, 15), xlab = t)
```

***

#### Positive (metastatic) inguinal lymph nodes
`r var <- nodes; var.t <- table(var); t <- "Metastatic Inguinal Lymph Nodes"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptiveLN}
descriptive.plot(var, col = nice.colors, ylim = c(0, 20), xlab = t)
```

***

#### Time from treatment to lymphadenectomy
`r var <- date.lymph.mo; t <- "Time to Lymphadenectomy, Months"`

Statistics | Value
--- | :---:
Mean | `r round(mean(var, na.rm = TRUE), digits = 1)`
Standard Deviation | `r round(sd(var, na.rm = TRUE), digits = 1)`
Median | `r round(median(var, na.rm = TRUE), digits = 1)`
Interquartile Range | `r round(IQR(age, na.rm = TRUE), digits = 1)`
Minimum | `r min(var, na.rm = TRUE)`
Maximum | `r max(var, na.rm = TRUE)`

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptiveFollowUp}
descriptive.numeric(var, label = t)
```

***

### Treatment
#### Primary treatment
`r var <- treatment; var.t <- table(var); t <- "Primary Treatment"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)
`r levels(var)[3]` | `r var.t[3]` (`r round(var.t[3]/sum(var.t)*100, digits = 1)`)
`r levels(var)[4]` | `r var.t[4]` (`r round(var.t[4]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptiveTreatment}
descriptive.plot(var, col = rainbow(4), xlab = t, ylim = c(0, 55))
```

***

#### Adjuvant chemotherapy
`r var <- chemo; var.t <- table(var); t <- "Adjuvant Chemotherapy"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptiveAdjuvantChemo}
descriptive.plot(var, col = nice.colors, xlab = t, ylim = c(0, 45))
```

***

#### Adjuvant radiotherapy
`r var <- radio; var.t <- table(var); t <- "Adjuvant Radiotherapy"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptiveAdjuvantRadio}
descriptive.plot(var, col = nice.colors, xlab = t, ylim = c(0, 50))
```

***

### Outcome
#### Tumor recurrence
`r var <- recurrence; var.t <- table(var); t <- "Tumor Recurrence"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptiveRecurrence}
descriptive.plot(var, col = nice.colors, xlab = t, ylim = c(0, 45))
```

***

#### Time from primary treatment to tumor recurrence
`r var <- date.recurrence.mo; t <- "Time to Tumor Recurrence, Months"`

Statistics | Value
--- | :---:
Mean | `r round(mean(var, na.rm = TRUE), digits = 1)`
Standard Deviation | `r round(sd(var, na.rm = TRUE), digits = 1)`
Median | `r round(median(var, na.rm = TRUE), digits = 1)`
Interquartile Range | `r round(IQR(age, na.rm = TRUE), digits = 1)`
Minimum | `r min(var, na.rm = TRUE)`
Maximum | `r max(var, na.rm = TRUE)`

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptiveRecurrenceTime}
descriptive.numeric(var, label = t)
```

***

#### Tumor progression
`r var <- progression; var.t <- table(var); t <- "Tumor Progression"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptiveProgression}
descriptive.plot(var, col = nice.colors, xlab = t, ylim = c(0, 35))
```

***

#### Time from primary treatment to tumor progression
`r var <- date.progression.mo; t <- "Time to Tumor Progression, Months"`

Statistics | Value
--- | :---:
Mean | `r round(mean(var, na.rm = TRUE), digits = 1)`
Standard Deviation | `r round(sd(var, na.rm = TRUE), digits = 1)`
Median | `r round(median(var, na.rm = TRUE), digits = 1)`
Interquartile Range | `r round(IQR(age, na.rm = TRUE), digits = 1)`
Minimum | `r min(var, na.rm = TRUE)`
Maximum | `r max(var, na.rm = TRUE)`

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptiveProgressionTime}
descriptive.numeric(var, label = t)
```

***

#### Distant (visceral) metastasis
`r var <- mets; var.t <- table(var); t <- "Distant Metastasis"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptiveMets}
descriptive.plot(var, col = nice.colors, xlab = t, ylim = c(0, 30))
```

***

#### Time from primary treatment to distant metastasis
`r var <- date.met.mo; t <- "Time to Distant Metastasis, Months"`

Statistics | Value
--- | :---:
Mean | `r round(mean(var, na.rm = TRUE), digits = 1)`
Standard Deviation | `r round(sd(var, na.rm = TRUE), digits = 1)`
Median | `r round(median(var, na.rm = TRUE), digits = 1)`
Interquartile Range | `r round(IQR(age, na.rm = TRUE), digits = 1)`
Minimum | `r min(var, na.rm = TRUE)`
Maximum | `r max(var, na.rm = TRUE)`

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptiveMetsTime}
descriptive.numeric(var, label = t)
```

***

#### Patient's outcome
`r var <- outcome; var.t <- table(var)`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)
`r levels(var)[3]` | `r var.t[2]` (`r round(var.t[3]/sum(var.t)*100, digits = 1)`)
`r levels(var)[4]` | `r var.t[2]` (`r round(var.t[4]/sum(var.t)*100, digits = 1)`)
`r levels(var)[5]` | `r var.t[2]` (`r round(var.t[5]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptiveOutcome}
descriptive.plot.h(var, left = 9.5, col = rainbow(5), xlim = c(0, 20))
```

***

#### Total follow-up time (months)
`r var <- fu.last.mo; t <- "Follow-Up, Months"`

Statistics | Value
--- | :---:
Mean | `r round(mean(var, na.rm = TRUE), digits = 1)`
Standard Deviation | `r round(sd(var, na.rm = TRUE), digits = 1)`
Median | `r round(median(var, na.rm = TRUE), digits = 1)`
Interquartile Range | `r round(IQR(age, na.rm = TRUE), digits = 1)`
Minimum | `r min(var, na.rm = TRUE)`
Maximum | `r max(var, na.rm = TRUE)`

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptiveTotalFollowUp}
descriptive.numeric(var, label = t)
```

***

### EGFR expression
#### EGFR median score
`r var <- egfr.median.score; t <- "Median EGFR Score"`

Statistics | Value
--- | :---:
Mean | `r round(mean(var, na.rm = TRUE), digits = 1)`
Standard Deviation | `r round(sd(var, na.rm = TRUE), digits = 1)`
Median | `r round(median(var, na.rm = TRUE), digits = 1)`
Interquartile Range | `r round(IQR(age, na.rm = TRUE), digits = 1)`
Minimum | `r min(var, na.rm = TRUE)`
Maximum | `r max(var, na.rm = TRUE)`

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptiveEGFR.median}
descriptive.numeric(var, label = t)
```

***

#### EGFR categories
```{r DescriptiveEGFR}
EGFR <- cut(egfr.median.score, breaks = c(-Inf, 4, 8, Inf),
            labels = c("Negative EGFR", "Low EGFR", "High EGFR")
            )
```

`r var <- EGFR; var.t <- table(var); t <- "EGFR Expression"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)
`r levels(var)[3]` | `r var.t[3]` (`r round(var.t[3]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r DescriptiveEGFR.categories}
descriptive.plot(var, xlab = t, col = nice.colors, ylim = c(0, 30))
```

***

## Association Analysis

```{r DescriptiveFunctions}
# Set of functions to compare numerical variables across EGFR categories
mean.neg <- function(x){
        round(mean(x[EGFR == "Negative EGFR"], na.rm = TRUE), digits = 1)
}
mean.low <- function(x){
        round(mean(x[EGFR == "Low EGFR"], na.rm = TRUE), digits = 1)
}
mean.high <- function(x){
        round(mean(x[EGFR == "High EGFR"], na.rm = TRUE), digits = 1)
}
sd.neg <- function(x){
        round(sd(x[EGFR == "Negative EGFR"], na.rm = TRUE), digits = 1)
}
sd.low <- function(x){
        round(sd(x[EGFR == "Low EGFR"], na.rm = TRUE), digits = 1)
}
sd.high <- function(x){
        round(sd(x[EGFR == "High EGFR"], na.rm = TRUE), digits = 1)
}
median.neg <- function(x){
        round(median(x[EGFR == "Negative EGFR"], na.rm = TRUE), digits = 1)
}
median.low <- function(x){
        round(median(x[EGFR == "Low EGFR"], na.rm = TRUE), digits = 1)
}
median.high <- function(x){
        round(median(x[EGFR == "High EGFR"], na.rm = TRUE), digits = 1)
}
iqr.neg <- function(x){
        round(IQR(x[EGFR == "Negative EGFR"], na.rm = TRUE), digits = 1)
}
iqr.low <- function(x){
        round(IQR(x[EGFR == "Low EGFR"], na.rm = TRUE), digits = 1)
}
iqr.high <- function(x){
        round(IQR(x[EGFR == "High EGFR"], na.rm = TRUE), digits = 1)
}
min.neg <- function(x){
        round(min(x[EGFR == "Negative EGFR"], na.rm = TRUE), digits = 1)
}
min.low <- function(x){
        round(min(x[EGFR == "Low EGFR"], na.rm = TRUE), digits = 1)
}
min.high <- function(x){
        round(min(x[EGFR == "High EGFR"], na.rm = TRUE), digits = 1)
}
max.neg <- function(x){
        round(max(x[EGFR == "Negative EGFR"], na.rm = TRUE), digits = 1)
}
max.low <- function(x){
        round(max(x[EGFR == "Low EGFR"], na.rm = TRUE), digits = 1)
}
max.high <- function(x){
        round(max(x[EGFR == "High EGFR"], na.rm = TRUE), digits = 1)
}
```

### Clinical features
#### Patient's age and EGFR
`r var <- age; t <- "Patient's Age, years"`

Statistics | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
Mean | `r mean.neg(var)` | `r mean.low(var)` | `r mean.high(var)`
Standard Deviation | `r sd.neg(var)` | `r sd.low(var)` | `r sd.high(var)`
Median | `r median.neg(var)` | `r median.low(var)` | `r median.high(var)`
Interquartile Range | `r iqr.neg(var)` | `r iqr.low(var)` | `r iqr.high(var)`
Minimum | `r min.neg(var)` | `r min.low(var)` | `r min.high(var)`
Maximum | `r max.neg(var)` | `r max.low(var)` | `r max.high(var)`

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.age}
boxplot.kruskal(var ~ EGFR, col = nice.colors, xlab = "EGFR Expression", ylab = t)
```

***

#### Patient's race and EGFR
`r var <- race; var.t <- table(var, EGFR); t <- "Patient's Race"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)
`r levels(var)[3]` | `r var.t[3, 1]` (`r round(var.t[3, 1]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 2]` (`r round(var.t[3, 2]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 3]` (`r round(var.t[3, 3]/sum(var.t[3, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.race.plots}
compare.mosaic(var, EGFR, las = 1, main = t)
descriptive.plot.beside(EGFR, var, ylim = c(0, 23), xlab = t)
```

***

### Pathologic features
#### Histologic subtype and EGFR
`r var <- subtype; var.t <- table(var, EGFR); t <- "Histologic Subtype"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)
`r levels(var)[3]` | `r var.t[3, 1]` (`r round(var.t[3, 1]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 2]` (`r round(var.t[3, 2]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 3]` (`r round(var.t[3, 3]/sum(var.t[3, ]/100), digits = 1)`)
`r levels(var)[4]` | `r var.t[4, 1]` (`r round(var.t[4, 1]/sum(var.t[4, ]/100), digits = 1)`) | `r var.t[4, 2]` (`r round(var.t[4, 2]/sum(var.t[4, ]/100), digits = 1)`) | `r var.t[4, 3]` (`r round(var.t[4, 3]/sum(var.t[3, ]/100), digits = 1)`)
`r levels(var)[5]` | `r var.t[5, 1]` (`r round(var.t[5, 1]/sum(var.t[5, ]/100), digits = 1)`) | `r var.t[5, 2]` (`r round(var.t[5, 2]/sum(var.t[5, ]/100), digits = 1)`) | `r var.t[5, 3]` (`r round(var.t[5, 3]/sum(var.t[5, ]/100), digits = 1)`)
`r levels(var)[6]` | `r var.t[6, 1]` (`r round(var.t[6, 1]/sum(var.t[6, ]/100), digits = 1)`) | `r var.t[6, 2]` (`r round(var.t[6, 2]/sum(var.t[6, ]/100), digits = 1)`) | `r var.t[6, 3]` (`r round(var.t[6, 3]/sum(var.t[6, ]/100), digits = 1)`)
`r levels(var)[7]` | `r var.t[7, 1]` (`r round(var.t[7, 1]/sum(var.t[7, ]/100), digits = 1)`) | `r var.t[7, 2]` (`r round(var.t[7, 2]/sum(var.t[7, ]/100), digits = 1)`) | `r var.t[7, 3]` (`r round(var.t[7, 3]/sum(var.t[7, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.subtype.mosaic, fig.height = 7}
compare.mosaic(var, EGFR, las = 2, main = t)
```

```{r EGFR.subtype.bar}
descriptive.plot.beside(EGFR, var, ylim = c(0, 25))
```

***

#### Anatomical site and EGFR
`r var <- site; var.t <- table(var, EGFR); t <- "Anatomical Site"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)
`r levels(var)[3]` | `r var.t[3, 1]` (`r round(var.t[3, 1]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 2]` (`r round(var.t[3, 2]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 3]` (`r round(var.t[3, 3]/sum(var.t[3, ]/100), digits = 1)`)
`r levels(var)[4]` | `r var.t[4, 1]` (`r round(var.t[4, 1]/sum(var.t[4, ]/100), digits = 1)`) | `r var.t[4, 2]` (`r round(var.t[4, 2]/sum(var.t[4, ]/100), digits = 1)`) | `r var.t[4, 3]` (`r round(var.t[4, 3]/sum(var.t[3, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.site}
compare.mosaic(var, EGFR, main = t, las = 1)
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 20))
```

***

#### Anatomical level and EGFR
`r var <- level; var.t <- table(var, EGFR); t <- "Anatomical Level"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)
`r levels(var)[3]` | `r var.t[3, 1]` (`r round(var.t[3, 1]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 2]` (`r round(var.t[3, 2]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 3]` (`r round(var.t[3, 3]/sum(var.t[3, ]/100), digits = 1)`)
`r levels(var)[4]` | `r var.t[4, 1]` (`r round(var.t[4, 1]/sum(var.t[4, ]/100), digits = 1)`) | `r var.t[4, 2]` (`r round(var.t[4, 2]/sum(var.t[4, ]/100), digits = 1)`) | `r var.t[4, 3]` (`r round(var.t[4, 3]/sum(var.t[3, ]/100), digits = 1)`)
`r levels(var)[5]` | `r var.t[5, 1]` (`r round(var.t[5, 1]/sum(var.t[5, ]/100), digits = 1)`) | `r var.t[5, 2]` (`r round(var.t[5, 2]/sum(var.t[5, ]/100), digits = 1)`) | `r var.t[5, 3]` (`r round(var.t[5, 3]/sum(var.t[5, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.level}
compare.mosaic(var, EGFR, main = t, las = 1)
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 15))
```

***

#### Histologic grade and EGFR
`r var <- grade; var.t <- table(var, EGFR); t <- "Histologic Grade"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)
`r levels(var)[3]` | `r var.t[3, 1]` (`r round(var.t[3, 1]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 2]` (`r round(var.t[3, 2]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 3]` (`r round(var.t[3, 3]/sum(var.t[3, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.grade}
compare.mosaic(var, EGFR, main = t, las = 1)
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 15))
```

***

#### Tumor thickness and EGFR
`r var <- thick; var.t <- table(var, EGFR); t <- "Tumor Thickness"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)
`r levels(var)[3]` | `r var.t[3, 1]` (`r round(var.t[3, 1]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 2]` (`r round(var.t[3, 2]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 3]` (`r round(var.t[3, 3]/sum(var.t[3, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.thick}
compare.mosaic(var, EGFR, main = t, las = 1)
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 15))
```

***

#### Tumor invasion of penile urethra and EGFR
`r var <- urethra; var.t <- table(var, EGFR); t <- "Invasion of Penile Urethra"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.urethra}
compare.mosaic(var, EGFR, main = t, las = 1)
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 29))
```

***

#### Lymphovascular invasion and EGFR
`r var <- lvi; var.t <- table(var, EGFR); t <- "Lymphovascular Invasion"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.lvi}
compare.mosaic(var, EGFR, main = t, las = 1)
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 29))
```

***

#### Perineural invasion and EGFR
`r var <- pni; var.t <- table(var, EGFR); t <- "Perineural Invasion"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.pni.mosaic}
compare.mosaic(var, EGFR, main = t, las = 1)
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 20))
```

***

#### Pathological T stage and EGFR
`r var <- tnm.tumor; var.t <- table(var, EGFR); t <- "pT Stage"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)
`r levels(var)[3]` | `r var.t[3, 1]` (`r round(var.t[3, 1]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 2]` (`r round(var.t[3, 2]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 3]` (`r round(var.t[3, 3]/sum(var.t[3, ]/100), digits = 1)`)
`r levels(var)[4]` | `r var.t[4, 1]` (`r round(var.t[4, 1]/sum(var.t[4, ]/100), digits = 1)`) | `r var.t[4, 2]` (`r round(var.t[4, 2]/sum(var.t[4, ]/100), digits = 1)`) | `r var.t[4, 3]` (`r round(var.t[4, 3]/sum(var.t[3, ]/100), digits = 1)`)
`r levels(var)[5]` | `r var.t[5, 1]` (`r round(var.t[5, 1]/sum(var.t[5, ]/100), digits = 1)`) | `r var.t[5, 2]` (`r round(var.t[5, 2]/sum(var.t[5, ]/100), digits = 1)`) | `r var.t[5, 3]` (`r round(var.t[5, 3]/sum(var.t[5, ]/100), digits = 1)`)
`r levels(var)[6]` | `r var.t[6, 1]` (`r round(var.t[6, 1]/sum(var.t[6, ]/100), digits = 1)`) | `r var.t[6, 2]` (`r round(var.t[6, 2]/sum(var.t[6, ]/100), digits = 1)`) | `r var.t[6, 3]` (`r round(var.t[6, 3]/sum(var.t[6, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.pt.mosaic, fig.height = 7}
var <- ordered(var, c("T1a", "T1b", "T2", "T3", "T4", "Ta"))
compare.mosaic(var, EGFR, main = t, las = 1)
```

```{r EGFR.pt.bar}
var <- ordered(var, c("Ta", "T1a", "T1b", "T2", "T3", "T4"))
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 15))
```

***

#### Pathological N stage and EGFR
`r var <- tnm.nodes; var.t <- table(var, EGFR); t <- "pN Stage"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)
`r levels(var)[3]` | `r var.t[3, 1]` (`r round(var.t[3, 1]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 2]` (`r round(var.t[3, 2]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 3]` (`r round(var.t[3, 3]/sum(var.t[3, ]/100), digits = 1)`)
`r levels(var)[4]` | `r var.t[4, 1]` (`r round(var.t[4, 1]/sum(var.t[4, ]/100), digits = 1)`) | `r var.t[4, 2]` (`r round(var.t[4, 2]/sum(var.t[4, ]/100), digits = 1)`) | `r var.t[4, 3]` (`r round(var.t[4, 3]/sum(var.t[3, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.pn}
compare.mosaic(var, EGFR, main = t, las = 1)
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 10))
```

***

#### Clinical stage and EGFR
`r var <- stage; var.t <- table(var, EGFR); t <- "Clinical Stage"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)
`r levels(var)[3]` | `r var.t[3, 1]` (`r round(var.t[3, 1]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 2]` (`r round(var.t[3, 2]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 3]` (`r round(var.t[3, 3]/sum(var.t[3, ]/100), digits = 1)`)
`r levels(var)[4]` | `r var.t[4, 1]` (`r round(var.t[4, 1]/sum(var.t[4, ]/100), digits = 1)`) | `r var.t[4, 2]` (`r round(var.t[4, 2]/sum(var.t[4, ]/100), digits = 1)`) | `r var.t[4, 3]` (`r round(var.t[4, 3]/sum(var.t[3, ]/100), digits = 1)`)
`r levels(var)[5]` | `r var.t[5, 1]` (`r round(var.t[5, 1]/sum(var.t[5, ]/100), digits = 1)`) | `r var.t[5, 2]` (`r round(var.t[5, 2]/sum(var.t[5, ]/100), digits = 1)`) | `r var.t[5, 3]` (`r round(var.t[5, 3]/sum(var.t[5, ]/100), digits = 1)`)
`r levels(var)[6]` | `r var.t[6, 1]` (`r round(var.t[6, 1]/sum(var.t[6, ]/100), digits = 1)`) | `r var.t[6, 2]` (`r round(var.t[6, 2]/sum(var.t[6, ]/100), digits = 1)`) | `r var.t[6, 3]` (`r round(var.t[6, 3]/sum(var.t[6, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.stage.mosaic, fig.height = 7}
var <- ordered(var, c("Stage I", "Stage II", "Stage IIIa", "Stage IIIb", "Stage IV", "Stage 0"))
compare.mosaic(var, EGFR, main = t, las = 2)
```

```{r EGFR.stage.bar}
var <- ordered(var, c("Stage 0", "Stage I", "Stage II", "Stage IIIa", "Stage IIIb", "Stage IV"))
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 13))
```

***

#### Metastatic inguinal lymph nodes and EGFR
`r var <- nodes; var.t <- table(var, EGFR); t <- "Metastatic Inguinal Lymph Nodes"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.lymphnodes.mosaic}
compare.mosaic(var, EGFR, main = t, las = 1)
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 10))
```

***

### Outcome
#### Tumor recurrence and EGFR
`r var <- recurrence; var.t <- table(var, EGFR); t <- "Tumor Recurrence"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.recurrence.mosaic}
compare.mosaic(var, EGFR, main = t, las = 1)
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 23))
```

***

#### Tumor progression and EGFR
`r var <- progression; var.t <- table(var, EGFR); t <- "Tumor Progression"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.progression}
compare.mosaic(var, EGFR, main = t, las = 1)
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 20))
```

***

#### Distant metastasis and EGFR
`r var <- mets; var.t <- table(var, EGFR); t <- "Distant Metastasis"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.mets}
compare.mosaic(var, EGFR, main = t, las = 1)
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 18))
```

***

#### Overall mortality and EGFR
`r var <- dead; var.t <- table(var, EGFR); t <- "Overall Mortality"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.dead}
compare.mosaic(var, EGFR, main = t, las = 1)
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 22))
```

***

#### Cancer-related mortalitynd EGFR
`r var <- died.disease; var.t <- table(var, EGFR); t <- "Cancer-Related Mortality"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.dod}
compare.mosaic(var, EGFR, main = t, las = 1)
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 27))
```

***

### Adjusted P values

```{r AssociationP}
# Condensed KW test
k <- function(x){KW <- kruskal.test(x, EGFR); P <- KW$p.value}
# Condensed Fisher test
f <- function(x){FT <- fisher.test(x, EGFR); P <- FT$p.value} 
# Estimation of raw P values
p.age <- k(age) # 1
p.race <- f(race) # 2
p.subtype <- f(subtype) # 3
p.site <- f(site) # 4
p.level <- f(level) # 5
p.grade <- f(grade) # 6
p.thick <- f(thick) # 7
p.urethra <- f(urethra) # 8
p.lvi <- f(lvi) # 9
p.pni <- f(pni) # 10
p.pt <- f(tnm.tumor) # 11
p.pn <- f(tnm.nodes) # 12
p.stage <- f(stage) # 13
p.nodes <- f(nodes) # 14
p.recurrence <- f(recurrence) # 15
p.progression <- f(progression) # 16
p.mets <- f(mets) # 17
p.dead <- f(dead) # 18
p.dod <- f(died.disease) # 19
# List of raw P values
p.raw <- c(p.age, p.race, p.subtype, p.site, p.level, p.grade, p.thick, p.urethra, p.lvi, p.pni, p.pt, p.pn, p.stage, p.nodes, p.recurrence, p.progression, p.mets, p.dead, p.dod)
p.raw <- round(p.raw, digits = 2)
# Adjusting P values using Hommel's correction
p.adjusted <- p.adjust(p.raw, method = c("hommel"))
```

Variable | Raw P value | Adjusted P value
--- | :---: | :---:
Patient's age | `r p.raw[1]` | `r p.adjusted[1]`
Patient's race | `r p.raw[2]` | `r p.adjusted[2]`
Histologic subtype | `r p.raw[3]` | `r p.adjusted[3]`
Anatomical site | `r p.raw[4]` | `r p.adjusted[4]`
Anatomical level | `r p.raw[5]` | `r p.adjusted[5]`
Histologic grade | `r p.raw[6]` | `r p.adjusted[6]`
Tumor thickness | `r p.raw[7]` | `r p.adjusted[7]`
Urethra invasion | `r p.raw[8]` | `r p.adjusted[8]`
Lymphovascular invasion | `r p.raw[9]` | `r p.adjusted[9]`
Perineural invasion | `r p.raw[10]` | `r p.adjusted[10]`
Stage pT | `r p.raw[11]` | `r p.adjusted[11]`
Stage pN | `r p.raw[12]` | `r p.adjusted[12]`
Clinical stage | `r p.raw[13]` | `r p.adjusted[13]`
Metastatic inguinal lymph nodes | `r p.raw[14]` | `r p.adjusted[14]`
Tumor recurrence | `r p.raw[15]` | `r p.adjusted[15]`
Tumor progression | `r p.raw[16]` | `r p.adjusted[16]`
Distant metastasis | `r p.raw[17]` | `r p.adjusted[17]`
Overall mortality | `r p.raw[18]` | `r p.adjusted[18]`
Cancer-related mortality | `r p.raw[19]` | `r p.adjusted[19]`

## Survival Analysis
This section, currently under preparation, will include survival plots drawn using the Kapplan-Meier method and compared using the Mantel-Cox test.

***

## Odds Ratios
This section, currently under preparation, will report the odds ratios for outcome (tumor recurrence, tumor progression, distant metastasis, overall mortality, and cancer-related mortality) considering EGFR expression using unconditional logistic regression (unadjusted and adjusted) models.

***

## Hazard Ratios
This section, currently under preparation, will report the hazard ratios for outcome (tumor recurrence, tumor progression, distant metastasis, overall mortality, and cancer-related mortality) considering EGFR expression using Cox's proportional hazards regression (unadjusted and adjusted) models.
***
