# EGFR Expression in Penile Cancer
Last update: ```r {date()}```

```{r global_options}
library(knitr)
opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, fig.width = 9, results = "asis")
```

```{r DataSet}
# Loading the libraries and functions that will be used
source("RFUN/StandardAnalysis3.R")
source("RFUN/NicePlots.R")
source("RFUN/NiceTables.R")
library(foreign) # For reading STATA data
library(survival)
library(plyr) # for revalue and rename
require(ggplot2) # for forest plots
# Loading the STATA dataset
penis.full <- read.dta("../penile tma 6-11-14 stata 12.dta", convert.underscore = TRUE)
# Selecting clinicopathologic variables from the full dataset
clinicopath <- c("age", "race", "invasive", "subtype", "site", "grade", "thick", "lvi", "pni", "level", "urethra", "hpv.pos", "nodes", "date.lymph.mo", "dissection.type", "tnm.tumor", "tnm.nodes", "stage", "treatment", "chemo", "radio", "recurrence", "progression", "mets", "dead", "died.disease", "outcome", "date.recurrence.mo", "date.progression.mo", "date.met.mo", "date.death.mo", "fu.last.mo")
# Selecting markers from the full dataset
markers <- c("egfr.median.score", "egfr.max.score")
# Creating the dataset using the selected clinicopathologic variables and markers
penis.all <- penis.full[c(clinicopath, markers)]
# Recoding levels
penis.all$grade <- revalue(as.factor(penis.all$grade), c(
        "1" = "Grade 1",
        "2" = "Grade 2",
        "3" = "Grade 3"
        ))
penis.all$subtype <- gsub(pattern = " SCC", replacement = "", x = penis.all$subtype)
penis.all$subtype <- revalue(penis.all$subtype, c(
        "Other Subtype" = "Others",
        "Warty-Basaloid" = "WB"
        ))
penis.all$subtype <- as.factor(penis.all$subtype)
penis.all$level <- revalue(penis.all$level, c(
        "Corpus Spongiosum/Dartos" = "CS/Dartos",
        "Corpus Cavernosum/Preputial Skin" = "CC/Skin",
        "Adjacent Structures" = "Other"
        ))
penis.all$thick <- revalue(penis.all$thick, c(
        "< 5mm" = "Less than 5 mm",
        ">10 mm" = "More than 10 mm"
        ))
# Selecting only invasive cases and dropping unused levels
penis.data <- subset(penis.all, invasive == "Yes", select = -invasive)
penis.data <- droplevels(penis.data)
# Saving the dataset that is used for analysis
write.csv(penis.data, "PenisDataset.csv")
# Defining colors for plots
nice.colors <- c("turquoise", "coral", "cornflowerblue")
# Attaching the dataset
attach(penis.data)
```

```{r EGFRCategories}
# Defining cutoff points for EGFR scores
EGFR <- cut(egfr.median.score, breaks = c(-Inf, 4, 8, Inf),
            labels = c("Negative EGFR", "Low EGFR", "High EGFR")
            )
```

***

## Descriptive Analysis

### Clinical Features

#### Patient's age
`r var <- age; t <- "Patient's Age, years"`

Statistics | Value
--- | :---:
Mean | `r round(mean(var, na.rm = TRUE), digits = 1)`
Standard deviation | `r round(sd(var, na.rm = TRUE), digits = 1)`
Median | `r round(median(var, na.rm = TRUE), digits = 1)`
Interquartile range | `r round(IQR(var, na.rm = TRUE), digits = 1)`
Minimum | `r min(var, na.rm = TRUE)`
Maximum | `r max(var, na.rm = TRUE)`

*No. missing cases: `r sum(is.na(var))`*

```{r AgePlot}
descriptive.numeric(var, label = t)
```

***

#### Patient's race
`r var <- race; var.t <- table(var); t <- "Patient's Race"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)
`r levels(var)[3]` | `r var.t[3]` (`r round(var.t[3]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r RacePlot}
descriptive.plot(var, col = nice.colors, ylim = c(0, 40), xlab = t)
```

***

### Pathologic Features

#### Histologic subtype
`r var <- subtype; var.t <- table(var)`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)
`r levels(var)[3]` | `r var.t[3]` (`r round(var.t[3]/sum(var.t)*100, digits = 1)`)
`r levels(var)[4]` | `r var.t[4]` (`r round(var.t[4]/sum(var.t)*100, digits = 1)`)
`r levels(var)[5]` | `r var.t[5]` (`r round(var.t[5]/sum(var.t)*100, digits = 1)`)
`r levels(var)[6]` | `r var.t[6]` (`r round(var.t[6]/sum(var.t)*100, digits = 1)`)
`r levels(var)[7]` | `r var.t[7]` (`r round(var.t[7]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r SubtypePlot}
descriptive.plot.h(var, left = 10, col = rainbow(7), xlim = c(0, 40))
```

***

#### Anatomical site
`r var <- site; var.t <- table(var); t <- "Anatomical Site"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)
`r levels(var)[3]` | `r var.t[3]` (`r round(var.t[3]/sum(var.t)*100, digits = 1)`)
`r levels(var)[4]` | `r var.t[4]` (`r round(var.t[4]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r SitePlot}
descriptive.plot(var, col = rainbow(4), ylim = c(0, 35), xlab = t)
```

***

#### Anatomical level
`r var <- level; var.t <- table(var)`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)
`r levels(var)[3]` | `r var.t[3]` (`r round(var.t[3]/sum(var.t)*100, digits = 1)`)
`r levels(var)[4]` | `r var.t[4]` (`r round(var.t[4]/sum(var.t)*100, digits = 1)`)
`r levels(var)[5]` | `r var.t[5]` (`r round(var.t[5]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r LevelPlot}
descriptive.plot.h(var, left = 14, col = rainbow(5), xlim = c(0, 25))
```

***

#### Histologic grade
`r var <- grade; var.t <- table(var); t <- "Histologic Grade"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)
`r levels(var)[3]` | `r var.t[3]` (`r round(var.t[3]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r GradePlot}
descriptive.plot(var, col = nice.colors, ylim = c(0, 26), xlab = t)
```

***

#### Tumor thickness
`r var <- thick; var.t <- table(var); t <- "Tumor Thickness"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)
`r levels(var)[3]` | `r var.t[3]` (`r round(var.t[3]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r ThickPlot}
descriptive.plot(var, col = nice.colors, ylim = c(0, 25), xlab = t)
```

***

#### Tumor invasion of penile urethra
`r var <- urethra; var.t <- table(var); t <- "Invasion of Penile Urethra"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r UrethraPlot}
descriptive.plot(var, col = nice.colors, ylim = c(0, 50), xlab = t)
```

***

#### Lymphovascular invasion
`r var <- lvi; var.t <- table(var); t <- "Lymphovascular Invasion"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r LVIPlot}
descriptive.plot(var, col = nice.colors, ylim = c(0, 40), xlab = t)
```

***

#### Perineural invasion
`r var <- pni; var.t <- table(var); t <- "Perineural Invasion"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r PNIPlot}
descriptive.plot(var, col = nice.colors, ylim = c(0, 40), xlab = t)
```

***

#### HPV infection
`r var <- hpv.pos; var.t <- table(var); t <- "HPV Infection"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r HPVPlot}
descriptive.plot(var, col = nice.colors, xlab = t, ylim = c(0, 50))
```

***

#### Pathologic pT stage
`r var <- tnm.tumor; var.t <- table(var); t <- "pT Stage"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)
`r levels(var)[3]` | `r var.t[3]` (`r round(var.t[3]/sum(var.t)*100, digits = 1)`)
`r levels(var)[4]` | `r var.t[4]` (`r round(var.t[4]/sum(var.t)*100, digits = 1)`)
`r levels(var)[5]` | `r var.t[5]` (`r round(var.t[5]/sum(var.t)*100, digits = 1)`)
`r levels(var)[6]` | `r var.t[6]` (`r round(var.t[6]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r pTPlot}
descriptive.plot(var, col = rainbow(6), ylim = c(0, 25), xlab = t)
```

***

#### Pathologic pN stage
`r var <- tnm.nodes; var.t <- table(var); t <- "pN Stage"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)
`r levels(var)[3]` | `r var.t[3]` (`r round(var.t[3]/sum(var.t)*100, digits = 1)`)
`r levels(var)[4]` | `r var.t[4]` (`r round(var.t[4]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r pNPlot}
descriptive.plot(var, col = rainbow(4), ylim = c(0, 15), xlab = t)
```

***

#### Clinical stage
`r var <- stage; var.t <- table(var); t <- "Clinical Stage"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)
`r levels(var)[3]` | `r var.t[3]` (`r round(var.t[3]/sum(var.t)*100, digits = 1)`)
`r levels(var)[4]` | `r var.t[4]` (`r round(var.t[4]/sum(var.t)*100, digits = 1)`)
`r levels(var)[5]` | `r var.t[5]` (`r round(var.t[5]/sum(var.t)*100, digits = 1)`)
`r levels(var)[6]` | `r var.t[6]` (`r round(var.t[6]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r StagePlot}
descriptive.plot(var, col = rainbow(6), ylim = c(0, 20), xlab = t)
```

***

#### Inguinal lymph node dissection
`r var <- dissection.type; var.t <- table(var); t <- "Clinical Stage"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r DissectionPlot}
descriptive.plot(var, col = nice.colors, ylim = c(0, 15), xlab = t)
```

***

#### Positive (metastatic) inguinal lymph nodes
`r var <- nodes; var.t <- table(var); t <- "Metastatic Inguinal Lymph Nodes"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r LNPlot}
descriptive.plot(var, col = nice.colors, ylim = c(0, 20), xlab = t)
```

***

#### Time from treatment to lymphadenectomy
`r var <- date.lymph.mo; t <- "Time to Lymphadenectomy, Months"`

Statistics | Value
--- | :---:
Mean | `r round(mean(var, na.rm = TRUE), digits = 1)`
Standard deviation | `r round(sd(var, na.rm = TRUE), digits = 1)`
Median | `r round(median(var, na.rm = TRUE), digits = 1)`
Interquartile range | `r round(IQR(var, na.rm = TRUE), digits = 1)`
Minimum | `r min(var, na.rm = TRUE)`
Maximum | `r max(var, na.rm = TRUE)`

*No. missing cases: `r sum(is.na(var))`*

```{r FUPlot}
descriptive.numeric(var, label = t)
```

***

### Treatment
#### Primary treatment
`r var <- treatment; var.t <- table(var); t <- "Primary Treatment"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)
`r levels(var)[3]` | `r var.t[3]` (`r round(var.t[3]/sum(var.t)*100, digits = 1)`)
`r levels(var)[4]` | `r var.t[4]` (`r round(var.t[4]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r TreatmentPlot}
descriptive.plot(var, col = rainbow(4), xlab = t, ylim = c(0, 55))
```

***

#### Adjuvant chemotherapy
`r var <- chemo; var.t <- table(var); t <- "Adjuvant Chemotherapy"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r ChemoPlot}
descriptive.plot(var, col = nice.colors, xlab = t, ylim = c(0, 45))
```

***

#### Adjuvant radiotherapy
`r var <- radio; var.t <- table(var); t <- "Adjuvant Radiotherapy"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r RadioPlot}
descriptive.plot(var, col = nice.colors, xlab = t, ylim = c(0, 50))
```

***

### Outcome
#### Tumor recurrence
`r var <- recurrence; var.t <- table(var); t <- "Tumor Recurrence"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r RecurrencePlot}
descriptive.plot(var, col = nice.colors, xlab = t, ylim = c(0, 45))
```

***

#### Time from primary treatment to tumor recurrence
`r var <- date.recurrence.mo; t <- "Time to Tumor Recurrence, Months"`

Statistics | Value
--- | :---:
Mean | `r round(mean(var, na.rm = TRUE), digits = 1)`
Standard deviation | `r round(sd(var, na.rm = TRUE), digits = 1)`
Median | `r round(median(var, na.rm = TRUE), digits = 1)`
Interquartile range | `r round(IQR(var, na.rm = TRUE), digits = 1)`
Minimum | `r min(var, na.rm = TRUE)`
Maximum | `r max(var, na.rm = TRUE)`

*No. missing cases: `r sum(is.na(var))`*

```{r RecurrenceTimePlot}
descriptive.numeric(var, label = t)
```

***

#### Tumor progression
`r var <- progression; var.t <- table(var); t <- "Tumor Progression"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r ProgressionPlot}
descriptive.plot(var, col = nice.colors, xlab = t, ylim = c(0, 35))
```

***

#### Time from primary treatment to tumor progression
`r var <- date.progression.mo; t <- "Time to Tumor Progression, Months"`

Statistics | Value
--- | :---:
Mean | `r round(mean(var, na.rm = TRUE), digits = 1)`
Standard deviation | `r round(sd(var, na.rm = TRUE), digits = 1)`
Median | `r round(median(var, na.rm = TRUE), digits = 1)`
Interquartile range | `r round(IQR(var, na.rm = TRUE), digits = 1)`
Minimum | `r min(var, na.rm = TRUE)`
Maximum | `r max(var, na.rm = TRUE)`

*No. missing cases: `r sum(is.na(var))`*

```{r ProgressionTimePlot}
descriptive.numeric(var, label = t)
```

***

#### Distant (visceral) metastasis
`r var <- mets; var.t <- table(var); t <- "Distant Metastasis"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r MetsPlot}
descriptive.plot(var, col = nice.colors, xlab = t, ylim = c(0, 30))
```

***

#### Time from primary treatment to distant metastasis
`r var <- date.met.mo; t <- "Time to Distant Metastasis, Months"`

Statistics | Value
--- | :---:
Mean | `r round(mean(var, na.rm = TRUE), digits = 1)`
Standard deviation | `r round(sd(var, na.rm = TRUE), digits = 1)`
Median | `r round(median(var, na.rm = TRUE), digits = 1)`
Interquartile range | `r round(IQR(var, na.rm = TRUE), digits = 1)`
Minimum | `r min(var, na.rm = TRUE)`
Maximum | `r max(var, na.rm = TRUE)`

*No. missing cases: `r sum(is.na(var))`*

```{r MetsTimePlot}
descriptive.numeric(var, label = t)
```

***

#### Patient's outcome
`r var <- outcome; var.t <- table(var)`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)
`r levels(var)[3]` | `r var.t[3]` (`r round(var.t[3]/sum(var.t)*100, digits = 1)`)
`r levels(var)[4]` | `r var.t[4]` (`r round(var.t[4]/sum(var.t)*100, digits = 1)`)
`r levels(var)[5]` | `r var.t[5]` (`r round(var.t[5]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r OutcomePlot}
descriptive.plot.h(var, left = 9.5, col = rainbow(5), xlim = c(0, 20))
```

***

#### Total follow-up time (months)
`r var <- fu.last.mo; t <- "Follow-Up, Months"`

Statistics | Value
--- | :---:
Mean | `r round(mean(var, na.rm = TRUE), digits = 1)`
Standard deviation | `r round(sd(var, na.rm = TRUE), digits = 1)`
Median | `r round(median(var, na.rm = TRUE), digits = 1)`
Interquartile range | `r round(IQR(var, na.rm = TRUE), digits = 1)`
Minimum | `r min(var, na.rm = TRUE)`
Maximum | `r max(var, na.rm = TRUE)`

*No. missing cases: `r sum(is.na(var))`*

```{r OutcomeTimePlot}
descriptive.numeric(var, label = t)
```

***

### EGFR expression
#### EGFR median score
`r var <- egfr.median.score; t <- "Median EGFR Score"`

Statistics | Value
--- | :---:
Mean | `r round(mean(var, na.rm = TRUE), digits = 1)`
Standard deviation | `r round(sd(var, na.rm = TRUE), digits = 1)`
Median | `r round(median(var, na.rm = TRUE), digits = 1)`
Interquartile range | `r round(IQR(var, na.rm = TRUE), digits = 1)`
Minimum | `r min(var, na.rm = TRUE)`
Maximum | `r max(var, na.rm = TRUE)`

*No. missing cases: `r sum(is.na(var))`*

```{r EGFRScorePlot}
descriptive.numeric(var, label = t)
```

***

#### EGFR categories
`r var <- EGFR; var.t <- table(var); t <- "EGFR Expression"`

Categorical Level | No. Cases (%)
--- | :---:
`r levels(var)[1]` | `r var.t[1]` (`r round(var.t[1]/sum(var.t)*100, digits = 1)`)
`r levels(var)[2]` | `r var.t[2]` (`r round(var.t[2]/sum(var.t)*100, digits = 1)`)
`r levels(var)[3]` | `r var.t[3]` (`r round(var.t[3]/sum(var.t)*100, digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFRCategoriesPlot}
descriptive.plot(var, xlab = t, col = nice.colors, ylim = c(0, 30))
```

***

## Association Analysis

```{r DescriptiveFunctions}
# Set of functions to compare numerical variables across EGFR categories
mean.neg <- function(x){
        round(mean(x[EGFR == "Negative EGFR"], na.rm = TRUE), digits = 1)
}
mean.low <- function(x){
        round(mean(x[EGFR == "Low EGFR"], na.rm = TRUE), digits = 1)
}
mean.high <- function(x){
        round(mean(x[EGFR == "High EGFR"], na.rm = TRUE), digits = 1)
}
sd.neg <- function(x){
        round(sd(x[EGFR == "Negative EGFR"], na.rm = TRUE), digits = 1)
}
sd.low <- function(x){
        round(sd(x[EGFR == "Low EGFR"], na.rm = TRUE), digits = 1)
}
sd.high <- function(x){
        round(sd(x[EGFR == "High EGFR"], na.rm = TRUE), digits = 1)
}
median.neg <- function(x){
        round(median(x[EGFR == "Negative EGFR"], na.rm = TRUE), digits = 1)
}
median.low <- function(x){
        round(median(x[EGFR == "Low EGFR"], na.rm = TRUE), digits = 1)
}
median.high <- function(x){
        round(median(x[EGFR == "High EGFR"], na.rm = TRUE), digits = 1)
}
iqr.neg <- function(x){
        round(IQR(x[EGFR == "Negative EGFR"], na.rm = TRUE), digits = 1)
}
iqr.low <- function(x){
        round(IQR(x[EGFR == "Low EGFR"], na.rm = TRUE), digits = 1)
}
iqr.high <- function(x){
        round(IQR(x[EGFR == "High EGFR"], na.rm = TRUE), digits = 1)
}
min.neg <- function(x){
        round(min(x[EGFR == "Negative EGFR"], na.rm = TRUE), digits = 1)
}
min.low <- function(x){
        round(min(x[EGFR == "Low EGFR"], na.rm = TRUE), digits = 1)
}
min.high <- function(x){
        round(min(x[EGFR == "High EGFR"], na.rm = TRUE), digits = 1)
}
max.neg <- function(x){
        round(max(x[EGFR == "Negative EGFR"], na.rm = TRUE), digits = 1)
}
max.low <- function(x){
        round(max(x[EGFR == "Low EGFR"], na.rm = TRUE), digits = 1)
}
max.high <- function(x){
        round(max(x[EGFR == "High EGFR"], na.rm = TRUE), digits = 1)
}
```

### Clinical features
#### Patient's age and EGFR
`r var <- age; t <- "Patient's Age, years"`

Statistics | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
Mean | `r mean.neg(var)` | `r mean.low(var)` | `r mean.high(var)`
Standard deviation | `r sd.neg(var)` | `r sd.low(var)` | `r sd.high(var)`
Median | `r median.neg(var)` | `r median.low(var)` | `r median.high(var)`
Interquartile range | `r iqr.neg(var)` | `r iqr.low(var)` | `r iqr.high(var)`
Minimum | `r min.neg(var)` | `r min.low(var)` | `r min.high(var)`
Maximum | `r max.neg(var)` | `r max.low(var)` | `r max.high(var)`

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.age}
boxplot.kruskal(var ~ EGFR, col = nice.colors, xlab = "EGFR Expression", ylab = t)
```

***

#### Patient's race and EGFR
`r var <- race; var.t <- table(var, EGFR); t <- "Patient's Race"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)
`r levels(var)[3]` | `r var.t[3, 1]` (`r round(var.t[3, 1]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 2]` (`r round(var.t[3, 2]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 3]` (`r round(var.t[3, 3]/sum(var.t[3, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.race.plots}
compare.mosaic(var, EGFR, las = 1, main = t)
descriptive.plot.beside(EGFR, var, ylim = c(0, 23), xlab = t)
```

***

### Pathologic features
#### Histologic subtype and EGFR
`r var <- subtype; var.t <- table(var, EGFR); t <- "Histologic Subtype"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)
`r levels(var)[3]` | `r var.t[3, 1]` (`r round(var.t[3, 1]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 2]` (`r round(var.t[3, 2]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 3]` (`r round(var.t[3, 3]/sum(var.t[3, ]/100), digits = 1)`)
`r levels(var)[4]` | `r var.t[4, 1]` (`r round(var.t[4, 1]/sum(var.t[4, ]/100), digits = 1)`) | `r var.t[4, 2]` (`r round(var.t[4, 2]/sum(var.t[4, ]/100), digits = 1)`) | `r var.t[4, 3]` (`r round(var.t[4, 3]/sum(var.t[3, ]/100), digits = 1)`)
`r levels(var)[5]` | `r var.t[5, 1]` (`r round(var.t[5, 1]/sum(var.t[5, ]/100), digits = 1)`) | `r var.t[5, 2]` (`r round(var.t[5, 2]/sum(var.t[5, ]/100), digits = 1)`) | `r var.t[5, 3]` (`r round(var.t[5, 3]/sum(var.t[5, ]/100), digits = 1)`)
`r levels(var)[6]` | `r var.t[6, 1]` (`r round(var.t[6, 1]/sum(var.t[6, ]/100), digits = 1)`) | `r var.t[6, 2]` (`r round(var.t[6, 2]/sum(var.t[6, ]/100), digits = 1)`) | `r var.t[6, 3]` (`r round(var.t[6, 3]/sum(var.t[6, ]/100), digits = 1)`)
`r levels(var)[7]` | `r var.t[7, 1]` (`r round(var.t[7, 1]/sum(var.t[7, ]/100), digits = 1)`) | `r var.t[7, 2]` (`r round(var.t[7, 2]/sum(var.t[7, ]/100), digits = 1)`) | `r var.t[7, 3]` (`r round(var.t[7, 3]/sum(var.t[7, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.subtype.mosaic, fig.height = 7}
compare.mosaic(var, EGFR, las = 2, main = t)
```

```{r EGFR.subtype.bar}
descriptive.plot.beside(EGFR, var, ylim = c(0, 25))
```

***

#### Anatomical site and EGFR
`r var <- site; var.t <- table(var, EGFR); t <- "Anatomical Site"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)
`r levels(var)[3]` | `r var.t[3, 1]` (`r round(var.t[3, 1]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 2]` (`r round(var.t[3, 2]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 3]` (`r round(var.t[3, 3]/sum(var.t[3, ]/100), digits = 1)`)
`r levels(var)[4]` | `r var.t[4, 1]` (`r round(var.t[4, 1]/sum(var.t[4, ]/100), digits = 1)`) | `r var.t[4, 2]` (`r round(var.t[4, 2]/sum(var.t[4, ]/100), digits = 1)`) | `r var.t[4, 3]` (`r round(var.t[4, 3]/sum(var.t[3, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.site}
compare.mosaic(var, EGFR, main = t, las = 1)
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 20))
```

***

#### Anatomical level and EGFR
`r var <- level; var.t <- table(var, EGFR); t <- "Anatomical Level"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)
`r levels(var)[3]` | `r var.t[3, 1]` (`r round(var.t[3, 1]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 2]` (`r round(var.t[3, 2]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 3]` (`r round(var.t[3, 3]/sum(var.t[3, ]/100), digits = 1)`)
`r levels(var)[4]` | `r var.t[4, 1]` (`r round(var.t[4, 1]/sum(var.t[4, ]/100), digits = 1)`) | `r var.t[4, 2]` (`r round(var.t[4, 2]/sum(var.t[4, ]/100), digits = 1)`) | `r var.t[4, 3]` (`r round(var.t[4, 3]/sum(var.t[3, ]/100), digits = 1)`)
`r levels(var)[5]` | `r var.t[5, 1]` (`r round(var.t[5, 1]/sum(var.t[5, ]/100), digits = 1)`) | `r var.t[5, 2]` (`r round(var.t[5, 2]/sum(var.t[5, ]/100), digits = 1)`) | `r var.t[5, 3]` (`r round(var.t[5, 3]/sum(var.t[5, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.level}
compare.mosaic(var, EGFR, main = t, las = 1)
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 15))
```

***

#### Histologic grade and EGFR
`r var <- grade; var.t <- table(var, EGFR); t <- "Histologic Grade"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)
`r levels(var)[3]` | `r var.t[3, 1]` (`r round(var.t[3, 1]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 2]` (`r round(var.t[3, 2]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 3]` (`r round(var.t[3, 3]/sum(var.t[3, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.grade}
compare.mosaic(var, EGFR, main = t, las = 1)
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 15))
```

***

#### Tumor thickness and EGFR
`r var <- thick; var.t <- table(var, EGFR); t <- "Tumor Thickness"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)
`r levels(var)[3]` | `r var.t[3, 1]` (`r round(var.t[3, 1]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 2]` (`r round(var.t[3, 2]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 3]` (`r round(var.t[3, 3]/sum(var.t[3, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.thick}
compare.mosaic(var, EGFR, main = t, las = 1)
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 17))
```

***

#### Tumor invasion of penile urethra and EGFR
`r var <- urethra; var.t <- table(var, EGFR); t <- "Invasion of Penile Urethra"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.urethra}
compare.mosaic(var, EGFR, main = t, las = 1)
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 29))
```

***

#### Lymphovascular invasion and EGFR
`r var <- lvi; var.t <- table(var, EGFR); t <- "Lymphovascular Invasion"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.lvi}
compare.mosaic(var, EGFR, main = t, las = 1)
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 29))
```

***

#### Perineural invasion and EGFR
`r var <- pni; var.t <- table(var, EGFR); t <- "Perineural Invasion"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.pni.mosaic}
compare.mosaic(var, EGFR, main = t, las = 1)
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 20))
```

***

#### Pathological T stage and EGFR
`r var <- tnm.tumor; var.t <- table(var, EGFR); t <- "pT Stage"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)
`r levels(var)[3]` | `r var.t[3, 1]` (`r round(var.t[3, 1]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 2]` (`r round(var.t[3, 2]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 3]` (`r round(var.t[3, 3]/sum(var.t[3, ]/100), digits = 1)`)
`r levels(var)[4]` | `r var.t[4, 1]` (`r round(var.t[4, 1]/sum(var.t[4, ]/100), digits = 1)`) | `r var.t[4, 2]` (`r round(var.t[4, 2]/sum(var.t[4, ]/100), digits = 1)`) | `r var.t[4, 3]` (`r round(var.t[4, 3]/sum(var.t[3, ]/100), digits = 1)`)
`r levels(var)[5]` | `r var.t[5, 1]` (`r round(var.t[5, 1]/sum(var.t[5, ]/100), digits = 1)`) | `r var.t[5, 2]` (`r round(var.t[5, 2]/sum(var.t[5, ]/100), digits = 1)`) | `r var.t[5, 3]` (`r round(var.t[5, 3]/sum(var.t[5, ]/100), digits = 1)`)
`r levels(var)[6]` | `r var.t[6, 1]` (`r round(var.t[6, 1]/sum(var.t[6, ]/100), digits = 1)`) | `r var.t[6, 2]` (`r round(var.t[6, 2]/sum(var.t[6, ]/100), digits = 1)`) | `r var.t[6, 3]` (`r round(var.t[6, 3]/sum(var.t[6, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.pt.mosaic, fig.height = 7}
var <- ordered(var, c("T1a", "T1b", "T2", "T3", "T4", "Ta"))
compare.mosaic(var, EGFR, main = t, las = 1)
```

```{r EGFR.pt.bar}
var <- ordered(var, c("Ta", "T1a", "T1b", "T2", "T3", "T4"))
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 15))
```

***

#### Pathological N stage and EGFR
`r var <- tnm.nodes; var.t <- table(var, EGFR); t <- "pN Stage"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)
`r levels(var)[3]` | `r var.t[3, 1]` (`r round(var.t[3, 1]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 2]` (`r round(var.t[3, 2]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 3]` (`r round(var.t[3, 3]/sum(var.t[3, ]/100), digits = 1)`)
`r levels(var)[4]` | `r var.t[4, 1]` (`r round(var.t[4, 1]/sum(var.t[4, ]/100), digits = 1)`) | `r var.t[4, 2]` (`r round(var.t[4, 2]/sum(var.t[4, ]/100), digits = 1)`) | `r var.t[4, 3]` (`r round(var.t[4, 3]/sum(var.t[3, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.pn}
compare.mosaic(var, EGFR, main = t, las = 1)
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 10))
```

***

#### Clinical stage and EGFR
`r var <- stage; var.t <- table(var, EGFR); t <- "Clinical Stage"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)
`r levels(var)[3]` | `r var.t[3, 1]` (`r round(var.t[3, 1]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 2]` (`r round(var.t[3, 2]/sum(var.t[3, ]/100), digits = 1)`) | `r var.t[3, 3]` (`r round(var.t[3, 3]/sum(var.t[3, ]/100), digits = 1)`)
`r levels(var)[4]` | `r var.t[4, 1]` (`r round(var.t[4, 1]/sum(var.t[4, ]/100), digits = 1)`) | `r var.t[4, 2]` (`r round(var.t[4, 2]/sum(var.t[4, ]/100), digits = 1)`) | `r var.t[4, 3]` (`r round(var.t[4, 3]/sum(var.t[3, ]/100), digits = 1)`)
`r levels(var)[5]` | `r var.t[5, 1]` (`r round(var.t[5, 1]/sum(var.t[5, ]/100), digits = 1)`) | `r var.t[5, 2]` (`r round(var.t[5, 2]/sum(var.t[5, ]/100), digits = 1)`) | `r var.t[5, 3]` (`r round(var.t[5, 3]/sum(var.t[5, ]/100), digits = 1)`)
`r levels(var)[6]` | `r var.t[6, 1]` (`r round(var.t[6, 1]/sum(var.t[6, ]/100), digits = 1)`) | `r var.t[6, 2]` (`r round(var.t[6, 2]/sum(var.t[6, ]/100), digits = 1)`) | `r var.t[6, 3]` (`r round(var.t[6, 3]/sum(var.t[6, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.stage.mosaic, fig.height = 7}
var <- ordered(var, c("Stage I", "Stage II", "Stage IIIa", "Stage IIIb", "Stage IV", "Stage 0"))
compare.mosaic(var, EGFR, main = t, las = 2)
```

```{r EGFR.stage.bar}
var <- ordered(var, c("Stage 0", "Stage I", "Stage II", "Stage IIIa", "Stage IIIb", "Stage IV"))
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 13))
```

***

#### Metastatic inguinal lymph nodes and EGFR
`r var <- nodes; var.t <- table(var, EGFR); t <- "Metastatic Inguinal Lymph Nodes"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.lymphnodes.mosaic}
compare.mosaic(var, EGFR, main = t, las = 1)
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 10))
```

***

### Outcome
#### Tumor recurrence and EGFR
`r var <- recurrence; var.t <- table(var, EGFR); t <- "Tumor Recurrence"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.recurrence.mosaic}
compare.mosaic(var, EGFR, main = t, las = 1)
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 23))
```

***

#### Tumor progression and EGFR
`r var <- progression; var.t <- table(var, EGFR); t <- "Tumor Progression"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.progression}
compare.mosaic(var, EGFR, main = t, las = 1)
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 20))
```

***

#### Distant metastasis and EGFR
`r var <- mets; var.t <- table(var, EGFR); t <- "Distant Metastasis"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.mets}
compare.mosaic(var, EGFR, main = t, las = 1)
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 18))
```

***

#### Overall mortality and EGFR
`r var <- dead; var.t <- table(var, EGFR); t <- "Overall Mortality"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.dead}
compare.mosaic(var, EGFR, main = t, las = 1)
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 22))
```

***

#### Cancer-related mortality and EGFR
`r var <- died.disease; var.t <- table(var, EGFR); t <- "Cancer-Related Mortality"`

Categorical Level | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)

*No. missing cases: `r sum(is.na(var))`*

```{r EGFR.dod}
compare.mosaic(var, EGFR, main = t, las = 1)
descriptive.plot.beside(EGFR, var, xlab = t, ylim = c(0, 27))
```

***

### Adjusted P values

```{r AssociationP}
# Condensed KW test
k <- function(x){KW <- kruskal.test(x, EGFR); P <- KW$p.value}
# Condensed Fisher test
f <- function(x){FT <- fisher.test(x, EGFR); P <- FT$p.value} 
# Estimation of raw P values
p.age <- k(age)
p.race <- f(race)
p.subtype <- f(subtype)
p.site <- f(site)
p.level <- f(level)
p.grade <- f(grade)
p.thick <- f(thick)
p.urethra <- f(urethra)
p.lvi <- f(lvi)
p.pni <- f(pni)
p.pt <- f(tnm.tumor)
p.pn <- f(tnm.nodes)
p.stage <- f(stage)
p.nodes <- f(nodes)
p.recurrence <- f(recurrence)
p.progression <- f(progression)
p.mets <- f(mets)
p.dead <- f(dead)
p.dod <- f(died.disease)
# List of variable names
p.names <- c("Patient's age", "Patient's race", "Histologic subtype", "Anatomical site", "Anatomical level", "Histologic grade", "Tumor thickness", "Urethra invasion", "Lymphovascular invasion", "Perineural invasion", "Stage pT", "Stage pN", "Clinical stage", "Metastatic inguinal lymph nodes", "Tumor recurrence", "Tumor progression", "Distant metastasis", "Overall mortality", "Cancer-related mortality")
# List of raw P values
p.raw <- c(p.age, p.race, p.subtype, p.site, p.level, p.grade, p.thick, p.urethra, p.lvi, p.pni, p.pt, p.pn, p.stage, p.nodes, p.recurrence, p.progression, p.mets, p.dead, p.dod)
p.raw <- round(p.raw, digits = 2)
# Adjusting P values using Hommel's correction
p.adjusted <- p.adjust(p.raw, method = c("hommel"))
# Combining raw and adjusted P values
p.table <- cbind("Variables" = p.names, "Raw P values" = p.raw, "Adjusted P values" = p.adjusted)
# Creating the output table
kable(p.table, format = "markdown", align = c("l", "c", "c"))
```

***

## Survival Analysis
This section includes survival plots drawn using the Kapplan-Meier method and compared using the Mantel-Cox test, for each of the following outcomes: tumor recurrence, tumor progression, distant metastasis, overall mortality, and cancer-related mortality.

### Tumor recurrence
```{r DataRecurrence}
data.recurrence <- ifelse(is.na(date.recurrence.mo), c("No"), c("Yes"))
data.recurrence <- as.factor(data.recurrence)
```

`r var <- data.recurrence; var.t <- table(var, EGFR)`

Follow-up on tumor recurrence | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)

```{r OutcomeRecurrence, fig.height = 7}
survival.plot(x = EGFR, fu = date.recurrence.mo, outcome = recurrence, ylim = c(0, 1),
              title = "EGFR and Tumor Recurrence",
              levels = c("Low EGFR", "High EGFR"))
```

### Tumor progression
```{r DataProgression}
data.progression <- ifelse(is.na(date.progression.mo), c("No"), c("Yes"))
data.progression <- as.factor(data.progression)
```

`r var <- data.progression; var.t <- table(var, EGFR)`

Follow-up on tumor progression | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)

```{r OutcomeProgression, fig.height = 7}
survival.plot(x = EGFR, fu = date.progression.mo, outcome = progression, ylim = c(0, 1),
              title = "EGFR and Tumor Progression",
              levels = c("Negative EGFR", "High EGFR"))
```

### Distant metastasis
```{r DataMets}
data.met <- ifelse(is.na(date.met.mo), c("No"), c("Yes"))
data.met <- as.factor(data.met)
```

`r var <- data.met; var.t <- table(var, EGFR)`

Follow-up on distant metastasis | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)

```{r OutcomeMetastasis, fig.height = 7}
survival.plot(x = EGFR, fu = date.met.mo, outcome = mets, ylim = c(0, 1),
              title = "EGFR and Distant Metastasis",
              levels = c("Negative EGFR", "High EGFR"))
```

### Overall mortality
```{r DataDead}
data.dead <- ifelse(is.na(fu.last.mo), c("No"), c("Yes"))
data.dead <- as.factor(data.dead)
```

`r var <- data.dead; var.t <- table(var, EGFR)`

Follow-up on overall mortality | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)

```{r OutcomeDeath, fig.height = 7}
survival.plot(x = EGFR, fu = fu.last.mo, outcome = dead, ylim = c(0, 1),
              title = "EGFR and Overall Mortality",
              levels = c("Negative EGFR", "Low EGFR", "High EGFR"))
```

### Cancer-specific mortality
```{r DataDOD}
data.dod <- ifelse(is.na(fu.last.mo), c("No"), c("Yes"))
data.dod <- as.factor(data.dod)
```

`r var <- data.dod; var.t <- table(var, EGFR)`

Follow-up on cancer-specific mortality | Negative EGFR | Low EGFR | High EGFR
--- | :---: | :---: | :---:
`r levels(var)[1]` | `r var.t[1, 1]` (`r round(var.t[1, 1]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 2]` (`r round(var.t[1, 2]/sum(var.t[1, ]/100), digits = 1)`) | `r var.t[1, 3]` (`r round(var.t[1, 3]/sum(var.t[1, ]/100), digits = 1)`)
`r levels(var)[2]` | `r var.t[2, 1]` (`r round(var.t[2, 1]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 2]` (`r round(var.t[2, 2]/sum(var.t[2, ]/100), digits = 1)`) | `r var.t[2, 3]` (`r round(var.t[2, 3]/sum(var.t[2, ]/100), digits = 1)`)

```{r OutcomeDOD, fig.height = 7}
survival.plot(x = EGFR, fu = fu.last.mo, outcome = died.disease, ylim = c(0.4, 1),
              title = "EGFR and Cancer-Related Death",
              levels = c("Negative EGFR", "Low EGFR", "High EGFR"))
```

***

## Odds Ratios
This section reports the odds ratios (OR) for outcome (tumor recurrence, tumor progression, distant metastasis, overall mortality, and cancer-related mortality) considering EGFR expression (high vs. low/negative) using unconditional logistic regression models. Variables with extremely low or extremely high OR were dropped from the report.

```{r OR.recode}
# Recoding levels for logistic regression
older <- ifelse(age > median(age), c("Yes"), c("No"))
caucasian <- ifelse(race == "Caucasian", c("Yes"), c("No"))
glans <- ifelse(site == "Glans", c("Yes"), c("No"))
lp <- ifelse(level == "Lamina Propria", c("Yes"), c("No"))
high.grade <- ifelse(grade == "Grade 3", c("Yes"), c("No"))
deep <- ifelse(thick == "More than 10 mm", c("Yes"), c("No"))
high.pt <- as.factor(ifelse(as.numeric(tnm.tumor) > 3, c("Yes"), c("No")))
high.pn <- as.factor(ifelse(as.numeric(tnm.nodes) > 1, c("Yes"), c("No")))
high.stage <- as.factor(ifelse(as.numeric(stage) > 3, c("Yes"), c("No")))
prophylactic <- ifelse(dissection.type == "Prophylactic", c("Yes"), c("No"))
high.EGFR <- ifelse(EGFR == "High EGFR", c("Yes"), c("No"))
```

### Tumor recurrence
#### Odds ratios for tumor recurrence
```{r OR.recurrence}
var <- recurrence

# Regression models
age.OR <- glm(var ~ older, family = binomial)
race.OR <- glm(var ~ caucasian, family = binomial) # Dropped
site.OR <- glm(var ~ glans, family = binomial)
level.OR <- glm(var ~ lp, family = binomial)
grade.OR <- glm(var ~ high.grade, family = binomial) # Dropped
thick.OR <- glm(var ~ deep, family = binomial)
urethra.OR <- glm(var ~ urethra, family = binomial) # Dropped
lvi.OR <- glm(var ~ lvi, family = binomial)
pni.OR <- glm(var ~ pni, family = binomial)
hpv.OR <- glm(var ~ hpv.pos, family = binomial)
pt.OR <- glm (var ~ high.pt, family = binomial)
pn.OR <- glm (var ~ high.pn, family = binomial)
stage.OR <- glm (var ~ high.stage, family = binomial)
nodes.OR <- glm(var ~ nodes, family = binomial)
dissection.OR <- glm(var ~ prophylactic, family = binomial) # Dropped
EGFR.OR <- glm(var ~ high.EGFR, family = binomial)

# OR table
OR.variables <- c("Patient's age > median", "Glans location", "Invasion limited to lamina propria", "Deep invasive tumor (> 10 mm)", "Lymphovascular invasion", "Perineural invasion", "HPV infection", "High pT stage (> pT1)", "High pN stage (> pN0)", "High clinical stage (> Stage II)", "Metastatic inguinal lymph nodes", "High EGFR expression")

OR.center <- c(exp(coef(age.OR))[2], exp(coef(site.OR))[2], exp(coef(level.OR))[2], exp(coef(thick.OR))[2], exp(coef(lvi.OR))[2], exp(coef(pni.OR))[2], exp(coef(hpv.OR))[2], exp(coef(pt.OR))[2], exp(coef(pn.OR))[2], exp(coef(stage.OR))[2], exp(coef(nodes.OR))[2], exp(coef(EGFR.OR))[2])

OR.low <- c(exp(confint(age.OR))[2, 1], exp(confint(site.OR))[2, 1], exp(confint(level.OR))[2, 1], exp(confint(thick.OR))[2, 1], exp(confint(lvi.OR))[2, 1], exp(confint(pni.OR))[2, 1], exp(confint(hpv.OR))[2, 1], exp(confint(pt.OR))[2, 1], exp(confint(pn.OR))[2, 1], exp(confint(stage.OR))[2, 1], exp(confint(nodes.OR))[2, 1], exp(confint(EGFR.OR))[2, 1])

OR.high <- c(exp(confint(age.OR))[2, 2], exp(confint(site.OR))[2, 2], exp(confint(level.OR))[2, 2], exp(confint(thick.OR))[2, 2], exp(confint(lvi.OR))[2, 2], exp(confint(pni.OR))[2, 2], exp(confint(hpv.OR))[2, 2], exp(confint(pt.OR))[2, 2], exp(confint(pn.OR))[2, 2], exp(confint(stage.OR))[2, 2], exp(confint(nodes.OR))[2, 2], exp(confint(EGFR.OR))[2, 2])

OR.p <- c(summary(age.OR)$coef[2, 4], summary(site.OR)$coef[2, 4], summary(level.OR)$coef[2, 4], summary(thick.OR)$coef[2, 4], summary(lvi.OR)$coef[2, 4], summary(pni.OR)$coef[2, 4], summary(hpv.OR)$coef[2, 4], summary(pt.OR)$coef[2, 4], summary(pn.OR)$coef[2, 4], summary(stage.OR)$coef[2, 4], summary(nodes.OR)$coef[2, 4], summary(EGFR.OR)$coef[2, 4])

OR.table <- cbind("Variable" = OR.variables, "OR" = round(OR.center, digits = 2), "Lower 95% CI" = round(OR.low, digits = 2), "Upper 95% CI" = round(OR.high, digits = 2), "P value" = round(OR.p, digits = 4))

kable(OR.table, row.names = FALSE, align = c("l", "c", "c", "c", "c"))
```

<small>The following variables were dropped: caucasian race, high grade tumor (grade 3), invasion of penile urethra, and prophylactic inguinal lymph node dissection.</small><br><br>

#### Forest plot for tumor recurrence
```{r RecurrenceForestPlot}
ggplot(data = data.frame(OR.table), aes(x = OR.variables, y = OR.center, ymin = OR.low, ymax = OR.high)) +
        geom_errorbar(width = 0.25, size = 0.75) + 
        geom_hline(y = 1, linetype = "longdash") +
        geom_point(size = 2, shape = 15) + 
        coord_flip() +
        xlab("") + ylab("Odds ratios") + 
        theme_classic(base_size = 15, base_family = "")
```

***

### Tumor progression
#### Odds ratios for tumor progression
```{r OR.progression}
var <- progression

# Regression models
age.OR <- glm(var ~ older, family = binomial)
race.OR <- glm(var ~ caucasian, family = binomial)
site.OR <- glm(var ~ glans, family = binomial)
level.OR <- glm(var ~ lp, family = binomial)
grade.OR <- glm(var ~ high.grade, family = binomial)
thick.OR <- glm(var ~ deep, family = binomial)
urethra.OR <- glm(var ~ urethra, family = binomial)
lvi.OR <- glm(var ~ lvi, family = binomial)
pni.OR <- glm(var ~ pni, family = binomial)
hpv.OR <- glm(var ~ hpv.pos, family = binomial)
pt.OR <- glm (var ~ high.pt, family = binomial)
pn.OR <- glm (var ~ high.pn, family = binomial)
stage.OR <- glm (var ~ high.stage, family = binomial)
dissection.OR <- glm(var ~ prophylactic, family = binomial)
nodes.OR <- glm(var ~ nodes, family = binomial)
EGFR.OR <- glm(var ~ high.EGFR, family = binomial)

# OR table
OR.variables <- c("Patient's age > median", "Caucasian race", "Glans location", "Invasion limited to lamina propria", "High grade tumor (grade 3)", "Deep invasive tumor (> 10 mm)", "Invasion of penile urethra", "Lymphovascular invasion", "Perineural invasion", "HPV infection", "High pT stage (> pT1)", "High pN stage (> pN0)", "High clinical stage (> Stage II)", "Prophylactic inguinal lymph node dissection", "Metastatic inguinal lymph nodes", "High EGFR expression")

OR.center <- c(exp(coef(age.OR))[2], exp(coef(race.OR))[2], exp(coef(site.OR))[2], exp(coef(level.OR))[2], exp(coef(grade.OR))[2], exp(coef(thick.OR))[2], exp(coef(urethra.OR))[2], exp(coef(lvi.OR))[2], exp(coef(pni.OR))[2], exp(coef(hpv.OR))[2], exp(coef(pt.OR))[2], exp(coef(pn.OR))[2], exp(coef(stage.OR))[2], exp(coef(dissection.OR))[2], exp(coef(nodes.OR))[2], exp(coef(EGFR.OR))[2])

OR.low <- c(exp(confint(age.OR))[2, 1], exp(confint(race.OR))[2, 1], exp(confint(site.OR))[2, 1], exp(confint(level.OR))[2, 1], exp(confint(grade.OR))[2, 1], exp(confint(thick.OR))[2, 1], exp(confint(urethra.OR))[2, 1], exp(confint(lvi.OR))[2, 1], exp(confint(pni.OR))[2, 1], exp(confint(hpv.OR))[2, 1], exp(confint(pt.OR))[2, 1], exp(confint(pn.OR))[2, 1], exp(confint(stage.OR))[2, 1], exp(confint(dissection.OR))[2, 1], exp(confint(nodes.OR))[2, 1], exp(confint(EGFR.OR))[2, 1])

OR.high <- c(exp(confint(age.OR))[2, 2], exp(confint(race.OR))[2, 2], exp(confint(site.OR))[2, 2], exp(confint(level.OR))[2, 2], exp(confint(grade.OR))[2, 2], exp(confint(thick.OR))[2, 2], exp(confint(urethra.OR))[2, 2], exp(confint(lvi.OR))[2, 2], exp(confint(pni.OR))[2, 2], exp(confint(hpv.OR))[2, 2], exp(confint(pt.OR))[2, 2], exp(confint(pn.OR))[2, 2], exp(confint(stage.OR))[2, 2], exp(confint(dissection.OR))[2, 2], exp(confint(nodes.OR))[2, 2], exp(confint(EGFR.OR))[2, 2])

OR.p <- c(summary(age.OR)$coef[2, 4], summary(race.OR)$coef[2, 4], summary(site.OR)$coef[2, 4], summary(level.OR)$coef[2, 4], summary(grade.OR)$coef[2, 4], summary(thick.OR)$coef[2, 4], summary(urethra.OR)$coef[2, 4], summary(lvi.OR)$coef[2, 4], summary(pni.OR)$coef[2, 4], summary(hpv.OR)$coef[2, 4], summary(pt.OR)$coef[2, 4], summary(pn.OR)$coef[2, 4], summary(stage.OR)$coef[2, 4], summary(dissection.OR)$coef[2, 4], summary(nodes.OR)$coef[2, 4], summary(EGFR.OR)$coef[2, 4])

OR.table <- cbind("Variable" = OR.variables, "OR" = round(OR.center, digits = 2), "Lower 95% CI" = round(OR.low, digits = 2), "Upper 95% CI" = round(OR.high, digits = 2), "P value" = round(OR.p, digits = 4))

kable(OR.table, row.names = FALSE, align = c("l", "c", "c", "c", "c"))
```

<br><br>

#### Forest plot for tumor progression
```{r ProgressionForestPlot}
ggplot(data = data.frame(OR.table),
       aes(x = OR.variables, y = OR.center, ymin = OR.low, ymax = OR.high)) +
        geom_errorbar(width = 0.25, size = 0.75) + 
        geom_hline(y = 1, linetype = "longdash") +
        geom_point(size = 2, shape = 15) + 
        coord_flip() +
        xlab("") + ylab("Odds ratios") + 
        theme_classic(base_size = 15, base_family = "")
```

***

### Distant metastasis
#### Odds ratios for distant metastasis
```{r OR.mets}
var <- mets

# Regression models
age.OR <- glm(var ~ older, family = binomial)
race.OR <- glm(var ~ caucasian, family = binomial)
site.OR <- glm(var ~ glans, family = binomial)
level.OR <- glm(var ~ lp, family = binomial)
grade.OR <- glm(var ~ high.grade, family = binomial)
thick.OR <- glm(var ~ deep, family = binomial)
urethra.OR <- glm(var ~ urethra, family = binomial)
lvi.OR <- glm(var ~ lvi, family = binomial)
pni.OR <- glm(var ~ pni, family = binomial)
hpv.OR <- glm(var ~ hpv.pos, family = binomial)
pt.OR <- glm (var ~ high.pt, family = binomial)
pn.OR <- glm (var ~ high.pn, family = binomial) # Dropped
stage.OR <- glm (var ~ high.stage, family = binomial) # Dropped
nodes.OR <- glm(var ~ nodes, family = binomial) # Dropped
dissection.OR <- glm(var ~ prophylactic, family = binomial)
EGFR.OR <- glm(var ~ high.EGFR, family = binomial)

# OR table
OR.variables <- c("Patient's age > median", "Caucasian race", "Glans location", "Invasion limited to lamina propria", "High grade tumor (grade 3)", "Deep invasive tumor (> 10 mm)", "Invasion of penile urethra", "Lymphovascular invasion", "Perineural invasion", "HPV infection", "High pT stage (> pT1)", "Prophylactic inguinal lymph node dissection", "High EGFR expression")

OR.center <- c(exp(coef(age.OR))[2], exp(coef(race.OR))[2], exp(coef(site.OR))[2], exp(coef(level.OR))[2], exp(coef(grade.OR))[2], exp(coef(thick.OR))[2], exp(coef(urethra.OR))[2], exp(coef(lvi.OR))[2], exp(coef(pni.OR))[2], exp(coef(hpv.OR))[2], exp(coef(pt.OR))[2], exp(coef(dissection.OR))[2], exp(coef(EGFR.OR))[2])

OR.low <- c(exp(confint(age.OR))[2, 1], exp(confint(race.OR))[2, 1], exp(confint(site.OR))[2, 1], exp(confint(level.OR))[2, 1], exp(confint(grade.OR))[2, 1], exp(confint(thick.OR))[2, 1], exp(confint(urethra.OR))[2, 1], exp(confint(lvi.OR))[2, 1], exp(confint(pni.OR))[2, 1], exp(confint(hpv.OR))[2, 1], exp(confint(pt.OR))[2, 1], exp(confint(dissection.OR))[2, 1], exp(confint(EGFR.OR))[2, 1])

OR.high <- c(exp(confint(age.OR))[2, 2], exp(confint(race.OR))[2, 2], exp(confint(site.OR))[2, 2], exp(confint(level.OR))[2, 2], exp(confint(grade.OR))[2, 2], exp(confint(thick.OR))[2, 2], exp(confint(urethra.OR))[2, 2], exp(confint(lvi.OR))[2, 2], exp(confint(pni.OR))[2, 2], exp(confint(hpv.OR))[2, 2], exp(confint(pt.OR))[2, 2], exp(confint(dissection.OR))[2, 2], exp(confint(EGFR.OR))[2, 2])

OR.p <- c(summary(age.OR)$coef[2, 4], summary(race.OR)$coef[2, 4], summary(site.OR)$coef[2, 4], summary(level.OR)$coef[2, 4], summary(grade.OR)$coef[2, 4], summary(thick.OR)$coef[2, 4], summary(urethra.OR)$coef[2, 4], summary(lvi.OR)$coef[2, 4], summary(pni.OR)$coef[2, 4], summary(hpv.OR)$coef[2, 4], summary(pt.OR)$coef[2, 4], summary(dissection.OR)$coef[2, 4], summary(EGFR.OR)$coef[2, 4])

OR.table <- cbind("Variable" = OR.variables, "OR" = round(OR.center, digits = 2), "Lower 95% CI" = round(OR.low, digits = 2), "Upper 95% CI" = round(OR.high, digits = 2), "P value" = round(OR.p, digits = 4))

kable(OR.table, row.names = FALSE, align = c("l", "c", "c", "c", "c"))
```

<small>The following variables were dropped: high pT stage (> pN0), high clinical stage (> Stage II), and metastatic inguinal lymph nodes.</small><br><br>

#### Forest plot for distant metastasis
```{r MetsForestPlot}
ggplot(data = data.frame(OR.table),
       aes(x = OR.variables, y = OR.center, ymin = OR.low, ymax = OR.high)) +
        geom_errorbar(width = 0.25, size = 0.75) + 
        geom_hline(y = 1, linetype = "longdash") +
        geom_point(size = 2, shape = 15) + 
        coord_flip() +
        xlab("") + ylab("Odds ratios") + 
        theme_classic(base_size = 15, base_family = "")
```

***

### Overall mortality
#### Odds ratios for overall mortality
```{r OR.dead}
var <- dead

# Regression models
age.OR <- glm(var ~ older, family = binomial)
race.OR <- glm(var ~ caucasian, family = binomial)
site.OR <- glm(var ~ glans, family = binomial)
level.OR <- glm(var ~ lp, family = binomial)
grade.OR <- glm(var ~ high.grade, family = binomial)
thick.OR <- glm(var ~ deep, family = binomial)
urethra.OR <- glm(var ~ urethra, family = binomial)
lvi.OR <- glm(var ~ lvi, family = binomial)
pni.OR <- glm(var ~ pni, family = binomial)
hpv.OR <- glm(var ~ hpv.pos, family = binomial)
pt.OR <- glm (var ~ high.pt, family = binomial)
pn.OR <- glm (var ~ high.pn, family = binomial)
stage.OR <- glm (var ~ high.stage, family = binomial)
nodes.OR <- glm(var ~ nodes, family = binomial)
dissection.OR <- glm(var ~ prophylactic, family = binomial)
EGFR.OR <- glm(var ~ high.EGFR, family = binomial)

# OR table
OR.variables <- c("Patient's age > median", "Caucasian race", "Glans location", "Invasion limited to lamina propria", "High grade tumor (grade 3)", "Deep invasive tumor (> 10 mm)", "Invasion of penile urethra", "Lymphovascular invasion", "Perineural invasion", "HPV infection", "High pT stage (> pT1)", "High pN stage (> pN0)", "High clinical stage (> Stage II)", "Prophylactic inguinal lymph node dissection", "Metastatic inguinal lymph nodes", "High EGFR expression")

OR.center <- c(exp(coef(age.OR))[2], exp(coef(race.OR))[2], exp(coef(site.OR))[2], exp(coef(level.OR))[2], exp(coef(grade.OR))[2], exp(coef(thick.OR))[2], exp(coef(urethra.OR))[2], exp(coef(lvi.OR))[2], exp(coef(pni.OR))[2], exp(coef(hpv.OR))[2], exp(coef(pt.OR))[2], exp(coef(pn.OR))[2], exp(coef(stage.OR))[2], exp(coef(dissection.OR))[2], exp(coef(nodes.OR))[2], exp(coef(EGFR.OR))[2])

OR.low <- c(exp(confint(age.OR))[2, 1], exp(confint(race.OR))[2, 1], exp(confint(site.OR))[2, 1], exp(confint(level.OR))[2, 1], exp(confint(grade.OR))[2, 1], exp(confint(thick.OR))[2, 1], exp(confint(urethra.OR))[2, 1], exp(confint(lvi.OR))[2, 1], exp(confint(pni.OR))[2, 1], exp(confint(hpv.OR))[2, 1], exp(confint(pt.OR))[2, 1], exp(confint(pn.OR))[2, 1], exp(confint(stage.OR))[2, 1], exp(confint(dissection.OR))[2, 1], exp(confint(nodes.OR))[2, 1], exp(confint(EGFR.OR))[2, 1])

OR.high <- c(exp(confint(age.OR))[2, 2], exp(confint(race.OR))[2, 2], exp(confint(site.OR))[2, 2], exp(confint(level.OR))[2, 2], exp(confint(grade.OR))[2, 2], exp(confint(thick.OR))[2, 2], exp(confint(urethra.OR))[2, 2], exp(confint(lvi.OR))[2, 2], exp(confint(pni.OR))[2, 2], exp(confint(hpv.OR))[2, 2], exp(confint(pt.OR))[2, 2], exp(confint(pn.OR))[2, 2], exp(confint(stage.OR))[2, 2], exp(confint(dissection.OR))[2, 2], exp(confint(nodes.OR))[2, 2], exp(confint(EGFR.OR))[2, 2])

OR.p <- c(summary(age.OR)$coef[2, 4], summary(race.OR)$coef[2, 4], summary(site.OR)$coef[2, 4], summary(level.OR)$coef[2, 4], summary(grade.OR)$coef[2, 4], summary(thick.OR)$coef[2, 4], summary(urethra.OR)$coef[2, 4], summary(lvi.OR)$coef[2, 4], summary(pni.OR)$coef[2, 4], summary(hpv.OR)$coef[2, 4], summary(pt.OR)$coef[2, 4], summary(pn.OR)$coef[2, 4], summary(stage.OR)$coef[2, 4], summary(dissection.OR)$coef[2, 4], summary(nodes.OR)$coef[2, 4], summary(EGFR.OR)$coef[2, 4])

OR.table <- cbind("Variable" = OR.variables, "OR" = round(OR.center, digits = 2), "Lower 95% CI" = round(OR.low, digits = 2), "Upper 95% CI" = round(OR.high, digits = 2), "P value" = round(OR.p, digits = 4))

kable(OR.table, row.names = FALSE, align = c("l", "c", "c", "c", "c"))
```

<br><br>

#### Forest plot for overall mortality
```{r DeadForestPlot}
ggplot(data = data.frame(OR.table),
       aes(x = OR.variables, y = OR.center, ymin = OR.low, ymax = OR.high)) +
        geom_errorbar(width = 0.25, size = 0.75) + 
        geom_hline(y = 1, linetype = "longdash") +
        geom_point(size = 2, shape = 15) + 
        coord_flip() +
        xlab("") + ylab("Odds ratios") + 
        theme_classic(base_size = 15, base_family = "")
```

***

### Cancer-specific mortality
#### Odds ratios for cancer-specific mortality
```{r OR.DOD}
var <- died.disease

# Regression models
age.OR <- glm(var ~ older, family = binomial)
race.OR <- glm(var ~ caucasian, family = binomial)
site.OR <- glm(var ~ glans, family = binomial)
level.OR <- glm(var ~ lp, family = binomial)
grade.OR <- glm(var ~ high.grade, family = binomial)
thick.OR <- glm(var ~ deep, family = binomial)
urethra.OR <- glm(var ~ urethra, family = binomial)
lvi.OR <- glm(var ~ lvi, family = binomial)
pni.OR <- glm(var ~ pni, family = binomial)
hpv.OR <- glm(var ~ hpv.pos, family = binomial)
pt.OR <- glm (var ~ high.pt, family = binomial)
pn.OR <- glm (var ~ high.pn, family = binomial)
stage.OR <- glm (var ~ high.stage, family = binomial)
nodes.OR <- glm(var ~ nodes, family = binomial)
dissection.OR <- glm(var ~ prophylactic, family = binomial)
EGFR.OR <- glm(var ~ high.EGFR, family = binomial)

# OR table
OR.variables <- c("Patient's age > median", "Glans location", "Invasion limited to lamina propria", "High grade tumor (grade 3)", "Deep invasive tumor (> 10 mm)", "Invasion of penile urethra", "Lymphovascular invasion", "Perineural invasion", "HPV infection", "High pT stage (> pT1)", "High pN stage (> pN0)", "High clinical stage (> Stage II)", "Prophylactic inguinal lymph node dissection", "Metastatic inguinal lymph nodes", "High EGFR expression")

OR.center <- c(exp(coef(age.OR))[2], exp(coef(site.OR))[2], exp(coef(level.OR))[2], exp(coef(grade.OR))[2], exp(coef(thick.OR))[2], exp(coef(urethra.OR))[2], exp(coef(lvi.OR))[2], exp(coef(pni.OR))[2], exp(coef(hpv.OR))[2], exp(coef(pt.OR))[2], exp(coef(pn.OR))[2], exp(coef(stage.OR))[2], exp(coef(dissection.OR))[2], exp(coef(nodes.OR))[2], exp(coef(EGFR.OR))[2])

OR.low <- c(exp(confint(age.OR))[2, 1], exp(confint(site.OR))[2, 1], exp(confint(level.OR))[2, 1], exp(confint(grade.OR))[2, 1], exp(confint(thick.OR))[2, 1], exp(confint(urethra.OR))[2, 1], exp(confint(lvi.OR))[2, 1], exp(confint(pni.OR))[2, 1], exp(confint(hpv.OR))[2, 1], exp(confint(pt.OR))[2, 1], exp(confint(pn.OR))[2, 1], exp(confint(stage.OR))[2, 1], exp(confint(dissection.OR))[2, 1], exp(confint(nodes.OR))[2, 1], exp(confint(EGFR.OR))[2, 1])

OR.high <- c(exp(confint(age.OR))[2, 2], exp(confint(site.OR))[2, 2], exp(confint(level.OR))[2, 2], exp(confint(grade.OR))[2, 2], exp(confint(thick.OR))[2, 2], exp(confint(urethra.OR))[2, 2], exp(confint(lvi.OR))[2, 2], exp(confint(pni.OR))[2, 2], exp(confint(hpv.OR))[2, 2], exp(confint(pt.OR))[2, 2], exp(confint(pn.OR))[2, 2], exp(confint(stage.OR))[2, 2], exp(confint(dissection.OR))[2, 2], exp(confint(nodes.OR))[2, 2], exp(confint(EGFR.OR))[2, 2])

OR.p <- c(summary(age.OR)$coef[2, 4], summary(site.OR)$coef[2, 4], summary(level.OR)$coef[2, 4], summary(grade.OR)$coef[2, 4], summary(thick.OR)$coef[2, 4], summary(urethra.OR)$coef[2, 4], summary(lvi.OR)$coef[2, 4], summary(pni.OR)$coef[2, 4], summary(hpv.OR)$coef[2, 4], summary(pt.OR)$coef[2, 4], summary(pn.OR)$coef[2, 4], summary(stage.OR)$coef[2, 4], summary(dissection.OR)$coef[2, 4], summary(nodes.OR)$coef[2, 4], summary(EGFR.OR)$coef[2, 4])

OR.table <- cbind("Variable" = OR.variables, "OR" = round(OR.center, digits = 2), "Lower 95% CI" = round(OR.low, digits = 2), "Upper 95% CI" = round(OR.high, digits = 2), "P value" = round(OR.p, digits = 4))

kable(OR.table, row.names = FALSE, align = c("l", "c", "c", "c", "c"))
```

<small>The following variable was dropped: caucasian race.</small><br><br>

#### Forest plot for cancer specific mortality
```{r DODForestPlot}
ggplot(data = data.frame(OR.table),
       aes(x = OR.variables, y = OR.center, ymin = OR.low, ymax = OR.high)) +
        geom_errorbar(width = 0.25, size = 0.75) + 
        geom_hline(y = 1, linetype = "longdash") +
        geom_point(size = 2, shape = 15) + 
        coord_flip() +
        xlab("") + ylab("Odds ratios") + 
        theme_classic(base_size = 15, base_family = "")
```

***

## Hazard Ratios
This section, currently under preparation, will report the hazard ratios for outcome (tumor recurrence, tumor progression, distant metastasis, overall mortality, and cancer-related mortality) considering EGFR expression using Cox's proportional hazards regression (unadjusted and adjusted) models.

***
